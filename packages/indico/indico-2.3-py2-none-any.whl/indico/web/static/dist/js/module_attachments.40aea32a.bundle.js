!function(t){function e(e){for(var a,r,c=e[0],l=e[1],s=e[2],h=0,u=[];h<c.length;h++)r=c[h],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&u.push(o[r][0]),o[r]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);for(d&&d(e);u.length;)u.shift()();return i.push.apply(i,s||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],a=!0,c=1;c<n.length;c++){var l=n[c];0!==o[l]&&(a=!1)}a&&(i.splice(e--,1),t=r(r.s=n[0]))}return t}var a={},o={144:0},i=[];function r(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.e=function(){return Promise.resolve()},r.m=t,r.c=a,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(n,a,function(e){return t[e]}.bind(null,a));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/dist/";var c=window.coreJsonp=window.coreJsonp||[],l=c.push.bind(c);c.push=e,c=c.slice();for(var s=0;s<c.length;s++)e(c[s]);var d=l;i.push([1905,0]),n()}({1905:function(t,e,n){t.exports=n(1906)},1906:function(t,e,n){(function(t){!function(e){"use strict";var n=!!history.pushState;function a(t){$(t.target).closest(".actions").length||$(this).toggleClass("collapsed").next(".sub-tree").find("td > div").slideToggle(150)}$(document).ready((function(){$(".attachments > .i-dropdown").parent().dropdown(),$("html").data("static-site")||setupAttachmentPreview(),$(document).on("click","[data-attachment-editor]",(function(t){t.preventDefault();var e=$(this);if(!this.disabled&&!e.hasClass("disabled")){var n=$(this).data("locator"),a=$(this).data("title"),o=void 0!==e.data("reload-on-change");openAttachmentManager(n,a,o,e)}}))})),e.setupAttachmentPreview=function(){var e=$(".js-preview-dialog"),a=location.href.replace(/#.*$/,"");function o(){n?history.back():location.hash=""}$.mobileBrowser||($(window).on("hashchange",(function(e,i){if(0!==location.hash.indexOf("#preview:"))$(".attachment-preview-dialog").trigger("ajaxDialog:close",[!0]);else{if(i&&n){var r=location.hash;history.replaceState({},document.title,a),history.pushState({},document.title,location.href+r)}!function(e){var n=$('.attachment[data-previewable][data-attachment-id="{0}"]'.format(e));if(!n.length)return void o();ajaxDialog({url:build_url(n.attr("href"),{preview:"1"}),title:n.data("title"),dialogClasses:"attachment-preview-dialog",onClose:function(t){$("body").off("keydown.attachmentPreview"),$("html, body").removeClass("prevent-scrolling"),t||o()},onOpen:function(e){var n=e.canvas.closest(".ui-dialog");n.prev(".ui-widget-overlay").addClass("attachment-preview-overlay"),e.canvas.find(".attachment-preview-content-wrapper, .js-close-preview").on("click",(function(){e.canvas.trigger("ajaxDialog:close")})),e.canvas.find(".attachment-download").on("click",(function(){var e=$(this),n=e.attr("href");e.attr("href",build_url(n,{from_preview:"1",download:"1"})),t.defer((function(){e.attr("href",n)}))})),e.canvas.find(".attachment-preview-content, .attachment-preview-top-bar").on("click",(function(t){t.stopPropagation()})),$("body").add(n).on("keydown.attachmentPreview",(function(t){t.which===$.ui.keyCode.ESCAPE&&e.canvas.trigger("ajaxDialog:close")})),$("html, body").addClass("prevent-scrolling"),t.defer((function(){n.show()}))},onLoadError:function(t){var e=location.hash;if(o(),404==t.status)return alertPopup($T.gettext("This file no longer exists. Please reload the page.")),!1;if(403==t.status){if(Indico.User&&void 0!==Indico.User.id)alertPopup($T("You are not authorized to access this file."),$T("Access Denied"));else{var n=$T("This file is protected. You will be redirected to the login page.");confirmPrompt(n,$T("Access Denied")).then((function(){location.href=build_url(Indico.Urls.Login,{next:location.href+e})}))}return!1}}})}(location.hash.split("#preview:")[1])}})).triggerHandler("hashchange",[!0]),e.on("click",(function(t){1!=t.which||t.shiftKey||t.metaKey||t.ctrlKey||t.altKey||(t.preventDefault(),location.hash="#preview:{0}".format($(this).data("attachmentId")))})))},e.setupAttachmentTreeView=function(){$(".attachments-box").on("click",".tree .expandable",a)},e.setupAttachmentEditor=function(){var t=$(".attachment-editor");function e(){t.trigger("ajaxDialog:setData",[!0])}t.on("click",".tree .expandable",a).on("click",".js-dialog-action",(function(t){t.preventDefault();var n=$(this);ajaxDialog({trigger:this,url:n.data("href"),title:n.data("title"),hidePageHeader:!0,onClose:function(t){t&&($("#attachments-container").html(t.attachment_list),e())}})})).on("indico:confirmed",".js-delete",(function(n){n.preventDefault();var a=$(this);$.ajax({url:a.data("href"),method:a.data("method"),complete:IndicoUI.Dialogs.Util.progress(),error:handleAjaxError,success:function(n){$("#attachments-container").html(n.attachment_list),handleFlashes(n,!0,t),e()}})}))},e.openAttachmentManager=function(t,e,n,a){n=void 0===n||n,ajaxDialog({trigger:a,url:build_url(Indico.Urls.AttachmentManager,t),title:e||$T.gettext("Manage material"),confirmCloseUnsaved:!1,hidePageHeader:!0,onClose:function(t,e){e&&n?location.reload():e&&a&&a.trigger("attachments:updated")}})},e.reloadManagementAttachmentInfoColumn=function(t,e){$.ajax({url:build_url(Indico.Urls.ManagementAttachmentInfoColumn,t),method:"GET",error:handleAjaxError,success:function(t){e.replaceWith(t.html)}})},e.messageIfFolderProtected=function(e,n,a,o,i,r){n.on("change",(function(){var t=$(this);a[t.val()]&&!e.prop("checked")?(o.hide(),i.hide(),r.find(".folder-name").html(t.children("option:selected").text()),r.show()):(r.hide(),o.toggle(e.prop("checked")),i.toggle(!e.prop("checked")))})),t.defer((function(){n.triggerHandler("change")}))},e.setupAttachmentTooltipButtons=function(){$(".attachments-tooltip-button").each((function(){var t=$(this);t.qtip({content:{text:t.next(".material_list")},show:{event:"click"},hide:{event:"unfocus"},position:{my:"top right",at:"bottom left"},events:{show:function(){t.addClass("open")},hide:function(){t.removeClass("open")}},style:{classes:"material_tip"}})}))}}(window)}).call(this,n(71).default)}});
//# sourceMappingURL=module_attachments.40aea32a.bundle.js.map