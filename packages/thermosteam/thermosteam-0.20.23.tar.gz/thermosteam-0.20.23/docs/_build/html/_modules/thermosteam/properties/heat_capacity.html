

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>thermosteam.properties.heat_capacity &mdash; Thermosteam  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> Thermosteam
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Overview.html">1. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Installation.html">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/An_hour_blitz_to_practical_thermodynamics.html">3. An hour blitz to practical thermodynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/Thermodynamic_equilibrium.html">4. Thermodynamic equilibrium</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/Thermo_property_packages.html">5. Thermo property packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/Stoichiometric_reactions.html">6. Stoichiometric reactions</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Chemical.html">Chemical</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Chemicals.html">Chemicals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Thermo.html">Thermo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Stream.html">Stream</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../MultiStream.html">MultiStream</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ThermalCondition.html">ThermalCondition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ThermoData.html">ThermoData</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functor.html">functor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../exceptions.html">exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functional.html">functional</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../equilibrium/equilibrium_module.html">equilibrium</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reaction/reaction_module.html">reaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../indexer/indexer_module.html">indexer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../properties/properties_module.html">properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mixture/mixture_module.html">mixture</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Thermosteam</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>thermosteam.properties.heat_capacity</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for thermosteam.properties.heat_capacity</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Data and methods for calculating the heat capacity of a chemical.</span>

<span class="sd">References</span>
<span class="sd">----------</span>
<span class="sd">.. [1] Lastovka, Vaclav, and John M. Shaw. &quot;Predictive Correlations for</span>
<span class="sd">       Ideal Gas Heat Capacities of Pure Hydrocarbons and Petroleum Fractions.&quot;</span>
<span class="sd">       Fluid Phase Equilibria 356 (October 25, 2013): 338-370.</span>
<span class="sd">       doi:10.1016/j.fluid.2013.07.023.</span>
<span class="sd">.. [2] Kabo, G. J., and G. N. Roganov. Thermodynamics of Organic Compounds</span>
<span class="sd">       in the Gas State, Volume II: V. 2. College Station, Tex: CRC Press, 1994.</span>
<span class="sd">.. [3] Poling, Bruce E. The Properties of Gases and Liquids. 5th edition.</span>
<span class="sd">       New York: McGraw-Hill Professional, 2000.</span>
<span class="sd">.. [4] Gesellschaft, V. D. I., ed. VDI Heat Atlas. 2nd edition.</span>
<span class="sd">       Berlin; New York:: Springer, 2010.</span>
<span class="sd">.. [5] J.S. Rowlinson, Liquids and Liquid Mixtures, 2nd Ed.,</span>
<span class="sd">       Butterworth, London (1969).</span>
<span class="sd">.. [6] Dadgostar, Nafiseh, and John M. Shaw. &quot;A Predictive Correlation for</span>
<span class="sd">       the Constant-Pressure Specific Heat Capacity of Pure and Ill-Defined</span>
<span class="sd">       Liquid Hydrocarbons.&quot; Fluid Phase Equilibria 313 (January 15, 2012):</span>
<span class="sd">       211-226. doi:10.1016/j.fluid.2011.09.015.</span>
<span class="sd">.. [7] Zabransky, M., V. Ruzicka Jr, V. Majer, and Eugene S. Domalski.</span>
<span class="sd">       Heat Capacity of Liquids: Critical Review and Recommended Values.</span>
<span class="sd">       2 Volume Set. Washington, D.C.: Amer Inst of Physics, 1996.</span>
<span class="sd">.. [8] Laštovka, Václav, Michal Fulem, Mildred Becerra, and John M. Shaw.</span>
<span class="sd">       &quot;A Similarity Variable for Estimating the Heat Capacity of Solid Organic</span>
<span class="sd">       Compounds: Part II. Application: Heat Capacity Calculation for</span>
<span class="sd">       Ill-Defined Organic Solids.&quot; Fluid Phase Equilibria 268, no. 1-2</span>
<span class="sd">       (June 25, 2008): 134-41. doi:10.1016/j.fluid.2008.03.018.</span>
<span class="sd">.. [9] Green, Don, and Robert Perry.</span>
<span class="sd">       Perry&#39;s Chemical Engineers&#39; Handbook,</span>
<span class="sd">       Eighth Edition. McGraw-Hill Professional, 2007.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="nb">open</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">log</span><span class="p">,</span> <span class="n">exp</span>
<span class="kn">from</span> <span class="nn">cmath</span> <span class="kn">import</span> <span class="n">log</span> <span class="k">as</span> <span class="n">clog</span><span class="p">,</span> <span class="n">exp</span> <span class="k">as</span> <span class="n">cexp</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">..base</span> <span class="kn">import</span> <span class="n">InterpolatedTDependentModel</span><span class="p">,</span> <span class="n">thermo_model</span><span class="p">,</span> <span class="n">TDependentHandleBuilder</span><span class="p">,</span> \
                   <span class="n">PhaseTHandleBuilder</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">Cn</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="n">to_nums</span><span class="p">,</span> <span class="n">CASDataReader</span>
<span class="kn">from</span> <span class="nn">.._constants</span> <span class="kn">import</span> <span class="n">R</span><span class="p">,</span> <span class="n">calorie</span>
<span class="kn">from</span> <span class="nn">..functional</span> <span class="kn">import</span> <span class="n">polylog2</span>
<span class="kn">from</span> <span class="nn">.miscdata</span> <span class="kn">import</span> <span class="n">VDI_saturation_dict</span><span class="p">,</span> <span class="n">VDI_tabular_data</span>
<span class="c1"># from .electrochem import (LaliberteHeatCapacityModel,</span>
<span class="c1">#                           _Laliberte_Heat_Capacity_ParametersDict)</span>
<span class="c1"># from .coolprop import has_CoolProp, coolprop_dict, CoolProp_T_dependent_property,\</span>
<span class="c1">#                       coolprop_fluids, PropsSI</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;heat_capacity_handle&#39;</span><span class="p">,</span>

           <span class="s1">&#39;Lastovka_Shaw&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Lastovka_Shaw_Integral&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Lastovka_Shaw_Integral_Over_T&#39;</span><span class="p">,</span>

           <span class="s1">&#39;TRCCn&#39;</span><span class="p">,</span> 
           <span class="s1">&#39;TRCCn_Integral&#39;</span><span class="p">,</span> 
           <span class="s1">&#39;TRCCn_Integral_Over_T&#39;</span><span class="p">,</span>

           <span class="s1">&#39;Poling&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Poling_Integral&#39;</span><span class="p">,</span> 
           <span class="s1">&#39;Poling_Integral_Over_T&#39;</span><span class="p">,</span>
           
           <span class="s1">&#39;Rowlinson_Poling&#39;</span><span class="p">,</span> <span class="s1">&#39;Rowlinson_Bondi&#39;</span><span class="p">,</span>

           <span class="s1">&#39;Zabransky_Cubic&#39;</span><span class="p">,</span> 
           <span class="s1">&#39;Zabransky_Cubic_Integral&#39;</span><span class="p">,</span> 
           <span class="s1">&#39;Zabransky_Cubic_Over_T_Integral&#39;</span><span class="p">,</span>

           <span class="s1">&#39;Zabransky_Quasi_Polynomial&#39;</span><span class="p">,</span> 
           <span class="s1">&#39;Zabransky_Quasi_Polynomial_Integral&#39;</span><span class="p">,</span> 
           <span class="s1">&#39;Zabransky_Quasi_Polynomial_Over_T_Integral&#39;</span><span class="p">,</span>

           <span class="s1">&#39;Dadgostar_Shaw&#39;</span><span class="p">,</span> 
           <span class="s1">&#39;Dadgostar_Shaw_Integral&#39;</span><span class="p">,</span> 
           <span class="s1">&#39;Dadgostar_Shaw_Over_T_Integral&#39;</span><span class="p">,</span>

           <span class="s1">&#39;Lastovka_Solid&#39;</span><span class="p">,</span> 
           <span class="s1">&#39;Lastovka_Solid_Integral&#39;</span><span class="p">,</span> 
           <span class="s1">&#39;Lastovka_Solid_Over_T_Integral&#39;</span><span class="p">,</span>
           
           <span class="s1">&#39;Perry_151&#39;</span><span class="p">,</span> 
           <span class="s1">&#39;Perry_151_Integral&#39;</span><span class="p">,</span> 
           <span class="s1">&#39;Perry_151_Over_T_Integral&#39;</span>
<span class="p">)</span>


<span class="c1"># %% Utilities</span>

<span class="k">def</span> <span class="nf">CnHS</span><span class="p">(</span><span class="n">FCn</span><span class="p">,</span> <span class="n">FH</span><span class="p">,</span> <span class="n">FS</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="n">fCn</span> <span class="o">=</span> <span class="n">FCn</span><span class="o">.</span><span class="n">from_args</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;evaluate&#39;</span><span class="p">:</span> <span class="n">fCn</span><span class="p">,</span>
            <span class="s1">&#39;integrate_by_T&#39;</span><span class="p">:</span> <span class="n">FH</span><span class="o">.</span><span class="n">from_other</span><span class="p">(</span><span class="n">fCn</span><span class="p">),</span>
            <span class="s1">&#39;integrate_by_T_over_T&#39;</span><span class="p">:</span> <span class="n">FS</span><span class="o">.</span><span class="n">from_other</span><span class="p">(</span><span class="n">fCn</span><span class="p">)}</span>

<span class="k">def</span> <span class="nf">CnHSModel</span><span class="p">(</span><span class="n">FCn</span><span class="p">,</span> <span class="n">FH</span><span class="p">,</span> <span class="n">FS</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">funcs</span> <span class="o">=</span> <span class="n">CnHS</span><span class="p">(</span><span class="n">FCn</span><span class="p">,</span> <span class="n">FH</span><span class="p">,</span> <span class="n">FS</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">thermo_model</span><span class="p">(</span><span class="n">Tmin</span><span class="o">=</span><span class="n">Tmin</span><span class="p">,</span> <span class="n">Tmax</span><span class="o">=</span><span class="n">Tmax</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">funcs</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ZabranskyModelBuilder</span><span class="p">:</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;casdata&#39;</span><span class="p">,</span> <span class="s1">&#39;funcs&#39;</span><span class="p">,</span> <span class="s1">&#39;many&#39;</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">casdata</span><span class="p">,</span> <span class="n">funcs</span><span class="p">,</span> <span class="n">many</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">casdata</span> <span class="o">=</span> <span class="n">casdata</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">funcs</span> <span class="o">=</span> <span class="n">funcs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">many</span> <span class="o">=</span> <span class="n">many</span>
    
    <span class="k">def</span> <span class="nf">add_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">CAS</span><span class="p">,</span> <span class="n">models</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">CAS</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">casdata</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">many</span><span class="p">:</span>
                <span class="n">models</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">build_model</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">casdata</span><span class="p">[</span><span class="n">CAS</span><span class="p">]])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">models</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">build_model</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">casdata</span><span class="p">[</span><span class="n">CAS</span><span class="p">]))</span>
    
    <span class="k">def</span> <span class="nf">build_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">Tmin</span><span class="p">,</span> <span class="n">Tmax</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">return</span> <span class="n">CnHSModel</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">funcs</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">Tmin</span><span class="p">,</span> <span class="n">Tmax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>


<span class="c1"># %% Data</span>

<span class="n">read</span> <span class="o">=</span> <span class="n">CASDataReader</span><span class="p">(</span><span class="vm">__file__</span><span class="p">,</span> <span class="s1">&#39;Heat Capacity&#39;</span><span class="p">)</span>
<span class="n">_Poling</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="s1">&#39;PolingDatabank.tsv&#39;</span><span class="p">)</span>
<span class="n">_TRC_gas</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="s1">&#39;TRC Thermodynamics of Organic Compounds in the Gas State.tsv&#39;</span><span class="p">)</span>
<span class="n">_CRC_standard</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="s1">&#39;CRC Standard Thermodynamic Properties of Chemical Substances.tsv&#39;</span><span class="p">)</span>
<span class="n">_PerryI</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">read</span><span class="o">.</span><span class="n">folder</span><span class="p">,</span> <span class="s1">&#39;Perrys Table 2-151.tsv&#39;</span><span class="p">),</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;Read in a dict of heat capacities of irnorganic and elemental solids.</span>
<span class="sd">    These are in section 2, table 151 in:</span>
<span class="sd">    Green, Don, and Robert Perry. Perry&#39;s Chemical Engineers&#39; Handbook,</span>
<span class="sd">    Eighth Edition. McGraw-Hill Professional, 2007.</span>

<span class="sd">    Formula:</span>
<span class="sd">    Cn(Cal/mol/K) = Const + Lin*T + Quadinv/T^2 + Quadinv*T^2</span>

<span class="sd">    Phases: c, gls, l, g.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="nb">next</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">to_nums</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">))</span>
        <span class="p">(</span><span class="n">CASRN</span><span class="p">,</span> <span class="n">_formula</span><span class="p">,</span> <span class="n">_phase</span><span class="p">,</span> <span class="n">_subphase</span><span class="p">,</span> <span class="n">Const</span><span class="p">,</span> <span class="n">Lin</span><span class="p">,</span> <span class="n">Quadinv</span><span class="p">,</span> <span class="n">Quad</span><span class="p">,</span> <span class="n">Tmin</span><span class="p">,</span>
         <span class="n">Tmax</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span> <span class="o">=</span> <span class="n">values</span>
        <span class="k">if</span> <span class="n">Lin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">Lin</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">Quadinv</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">Quadinv</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">Quad</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">Quad</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">CASRN</span> <span class="ow">in</span> <span class="n">_PerryI</span> <span class="ow">and</span> <span class="n">CASRN</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">_PerryI</span><span class="p">[</span><span class="n">CASRN</span><span class="p">]</span>
            <span class="n">a</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">_phase</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Formula&quot;</span><span class="p">:</span> <span class="n">_formula</span><span class="p">,</span> <span class="s2">&quot;Phase&quot;</span><span class="p">:</span> <span class="n">_phase</span><span class="p">,</span>
                               <span class="s2">&quot;Subphase&quot;</span><span class="p">:</span> <span class="n">_subphase</span><span class="p">,</span> <span class="s2">&quot;Const&quot;</span><span class="p">:</span> <span class="n">Const</span><span class="p">,</span>
                               <span class="s2">&quot;Lin&quot;</span><span class="p">:</span> <span class="n">Lin</span><span class="p">,</span> <span class="s2">&quot;Quadinv&quot;</span><span class="p">:</span> <span class="n">Quadinv</span><span class="p">,</span> <span class="s2">&quot;Quad&quot;</span><span class="p">:</span> <span class="n">Quad</span><span class="p">,</span>
                               <span class="s2">&quot;Tmin&quot;</span><span class="p">:</span> <span class="n">Tmin</span><span class="p">,</span> <span class="s2">&quot;Tmax&quot;</span><span class="p">:</span> <span class="n">Tmax</span><span class="p">,</span> <span class="s2">&quot;Error&quot;</span><span class="p">:</span> <span class="n">err</span><span class="p">}})</span>
            <span class="n">_PerryI</span><span class="p">[</span><span class="n">CASRN</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_PerryI</span><span class="p">[</span><span class="n">CASRN</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">_phase</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Formula&quot;</span><span class="p">:</span> <span class="n">_formula</span><span class="p">,</span> <span class="s2">&quot;Phase&quot;</span><span class="p">:</span> <span class="n">_phase</span><span class="p">,</span>
                                       <span class="s2">&quot;Subphase&quot;</span><span class="p">:</span> <span class="n">_subphase</span><span class="p">,</span> <span class="s2">&quot;Const&quot;</span><span class="p">:</span> <span class="n">Const</span><span class="p">,</span>
                                       <span class="s2">&quot;Lin&quot;</span><span class="p">:</span> <span class="n">Lin</span><span class="p">,</span> <span class="s2">&quot;Quadinv&quot;</span><span class="p">:</span> <span class="n">Quadinv</span><span class="p">,</span>
                                       <span class="s2">&quot;Quad&quot;</span><span class="p">:</span> <span class="n">Quad</span><span class="p">,</span> <span class="s2">&quot;Tmin&quot;</span><span class="p">:</span> <span class="n">Tmin</span><span class="p">,</span>
                                       <span class="s2">&quot;Tmax&quot;</span><span class="p">:</span> <span class="n">Tmax</span><span class="p">,</span> <span class="s2">&quot;Error&quot;</span><span class="p">:</span> <span class="n">err</span><span class="p">}}</span>



<span class="c1"># %% Heat Capacities Gas</span>
 
<span class="k">def</span> <span class="nf">calculate_Lastovka_Shaw_term</span><span class="p">(</span><span class="n">iscyclic_aliphatic</span><span class="p">,</span> <span class="n">similary_variable</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">iscyclic_aliphatic</span><span class="p">:</span>
        <span class="n">A1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1793547</span>
        <span class="n">A2</span> <span class="o">=</span> <span class="mf">3.86944439</span>
        <span class="n">term</span> <span class="o">=</span> <span class="n">A1</span> <span class="o">+</span> <span class="n">A2</span> <span class="o">*</span> <span class="n">similary_variable</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">A1</span> <span class="o">=</span> <span class="mf">0.58</span>
        <span class="n">A2</span> <span class="o">=</span> <span class="mf">1.25</span>
        <span class="n">A3</span> <span class="o">=</span> <span class="mf">0.17338003</span> <span class="c1"># 803 instead of 8003 in another paper</span>
        <span class="n">A4</span> <span class="o">=</span> <span class="mf">0.014</span>
        <span class="n">term</span> <span class="o">=</span> <span class="n">A2</span> <span class="o">+</span> <span class="p">(</span><span class="n">A1</span><span class="o">-</span><span class="n">A2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">exp</span><span class="p">((</span><span class="n">similary_variable</span> <span class="o">-</span> <span class="n">A3</span><span class="p">)</span><span class="o">/</span><span class="n">A4</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">term</span>

<div class="viewcode-block" id="Lastovka_Shaw"><a class="viewcode-back" href="../../../properties/heat_capacity.html#thermosteam.properties.heat_capacity.Lastovka_Shaw">[docs]</a><span class="nd">@Cn</span><span class="o">.</span><span class="n">g</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s2">&quot;[1]_&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">Lastovka_Shaw</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">MW</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">,</span> <span class="n">iscyclic_aliphatic</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The ideal-gas heat capacity (Cn.g; in J/mol/K) is given by:</span>

<span class="sd">    .. math::</span>
<span class="sd">        C_n^0 = MW \left(A_2 + \frac{A_1 - A_2}{1 + \exp(\frac{\alpha-A_3}{A_4})}\right)</span>
<span class="sd">        + (B_{11} + B_{12}\alpha)\left(-\frac{(C_{11} + C_{12}\alpha)}{T}\right)^2</span>
<span class="sd">        \frac{\exp(-(C_{11} + C_{12}\alpha)/T)}{[1-\exp(-(C_{11}+C_{12}\alpha)/T)]^2}\\</span>
<span class="sd">        + (B_{21} + B_{22}\alpha)\left(-\frac{(C_{21} + C_{22}\alpha)}{T}\right)^2</span>
<span class="sd">        \frac{\exp(-(C_{21} + C_{22}\alpha)/T)}{[1-\exp(-(C_{21}+C_{22}\alpha)/T)]^2}</span>

<span class="sd">    Original model is in terms of J/g/K, but is translated to molar heat capacity in J/mol/K.</span>

<span class="sd">    A1 = 0.58, A2 = 1.25, A3 = 0.17338003, A4 = 0.014,</span>
<span class="sd">    </span>
<span class="sd">    B11 = 0.73917383, B12 = 8.88308889,</span>
<span class="sd">    </span>
<span class="sd">    C11 = 1188.28051, C12 = 1813.04613,</span>
<span class="sd">    </span>
<span class="sd">    B21 = 0.0483019, B22 = 4.35656721, </span>
<span class="sd">    </span>
<span class="sd">    C21 = 2897.01927, C22 = 5987.80407.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Compute the heat capacity of Methane at 300 K:</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; f_Cng = Lastovka_Shaw(MW=16.043,</span>
<span class="sd">    ...                       similarity_variable=0.31166,</span>
<span class="sd">    ...                       iscyclic_aliphatic=False)</span>
<span class="sd">    &gt;&gt;&gt; f_Cng</span>
<span class="sd">    Functor: Lastovka_Shaw(T, P=None) -&gt; Cn.g [J/mol/K]</span>
<span class="sd">     MW: 16.043 g/mol</span>
<span class="sd">     similarity_variable: 0.31166</span>
<span class="sd">     iscyclic_aliphatic: 0</span>
<span class="sd">    &gt;&gt;&gt; f_Cng(T=400.0)</span>
<span class="sd">    33.91574477458602</span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">similarity_variable</span>
    <span class="n">term</span> <span class="o">=</span> <span class="n">calculate_Lastovka_Shaw_term</span><span class="p">(</span><span class="n">iscyclic_aliphatic</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
    <span class="n">B11</span> <span class="o">=</span> <span class="mf">0.73917383</span>
    <span class="n">B12</span> <span class="o">=</span> <span class="mf">8.88308889</span>
    <span class="n">C11</span> <span class="o">=</span> <span class="mf">1188.28051</span>
    <span class="n">C12</span> <span class="o">=</span> <span class="mf">1813.04613</span>
    <span class="n">B21</span> <span class="o">=</span> <span class="mf">0.0483019</span>
    <span class="n">B22</span> <span class="o">=</span> <span class="mf">4.35656721</span>
    <span class="n">C21</span> <span class="o">=</span> <span class="mf">2897.01927</span>
    <span class="n">C22</span> <span class="o">=</span> <span class="mf">5987.80407</span>
    <span class="k">return</span> <span class="n">MW</span> <span class="o">*</span> <span class="p">(</span><span class="n">term</span>
                 <span class="o">+</span> <span class="p">(</span><span class="n">B11</span> <span class="o">+</span> <span class="n">B12</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">C11</span><span class="o">+</span><span class="n">C12</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">C11</span> <span class="o">+</span> <span class="n">C12</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">C11</span><span class="o">+</span><span class="n">C12</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
                 <span class="o">+</span> <span class="p">(</span><span class="n">B21</span> <span class="o">+</span> <span class="n">B22</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">C21</span><span class="o">+</span><span class="n">C22</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">C21</span> <span class="o">+</span> <span class="n">C22</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">C21</span><span class="o">+</span><span class="n">C22</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span></div>

<span class="nd">@H</span><span class="o">.</span><span class="n">g</span>
<span class="k">def</span> <span class="nf">Lastovka_Shaw_Integral</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">MW</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">,</span> <span class="n">iscyclic_aliphatic</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">term</span> <span class="o">=</span> <span class="n">calculate_Lastovka_Shaw_term</span><span class="p">(</span><span class="n">iscyclic_aliphatic</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">Lastovka_Shat_Indefinite_Integral</span><span class="p">(</span><span class="n">Tb</span><span class="p">,</span> <span class="n">MW</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">,</span> <span class="n">term</span><span class="p">)</span>
            <span class="o">-</span> <span class="n">Lastovka_Shat_Indefinite_Integral</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span> <span class="n">MW</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">,</span> <span class="n">term</span><span class="p">))</span>

 
<span class="k">def</span> <span class="nf">Lastovka_Shat_Indefinite_Integral</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">MW</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">,</span> <span class="n">term</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">similarity_variable</span>
    <span class="n">B11</span> <span class="o">=</span> <span class="mf">0.73917383</span>
    <span class="n">B12</span> <span class="o">=</span> <span class="mf">8.88308889</span>
    <span class="n">C11</span> <span class="o">=</span> <span class="mf">1188.28051</span>
    <span class="n">C12</span> <span class="o">=</span> <span class="mf">1813.04613</span>
    <span class="n">B21</span> <span class="o">=</span> <span class="mf">0.0483019</span>
    <span class="n">B22</span> <span class="o">=</span> <span class="mf">4.35656721</span>
    <span class="n">C21</span> <span class="o">=</span> <span class="mf">2897.01927</span>
    <span class="n">C22</span> <span class="o">=</span> <span class="mf">5987.80407</span>
    <span class="k">return</span> <span class="n">MW</span> <span class="o">*</span> <span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">term</span> <span class="o">-</span> <span class="p">(</span><span class="n">B11</span> <span class="o">+</span> <span class="n">B12</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">C11</span> <span class="o">-</span> <span class="n">C12</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="n">C11</span> <span class="o">-</span> <span class="n">C12</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="n">C11</span> 
                 <span class="o">+</span> <span class="n">C12</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">((</span><span class="o">-</span><span class="n">C11</span> <span class="o">-</span> <span class="n">C12</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="n">B21</span> <span class="o">+</span> <span class="n">B22</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">C21</span> <span class="o">-</span> <span class="n">C22</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="n">C21</span> 
                 <span class="o">-</span> <span class="n">C22</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="n">C21</span> <span class="o">+</span> <span class="n">C22</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">((</span><span class="o">-</span><span class="n">C21</span> <span class="o">-</span> <span class="n">C22</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)))</span>

<span class="nd">@S</span><span class="o">.</span><span class="n">g</span>
<span class="k">def</span> <span class="nf">Lastovka_Shaw_Integral_Over_T</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">MW</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">,</span>
                                  <span class="n">iscyclic_aliphatic</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">term</span> <span class="o">=</span> <span class="n">calculate_Lastovka_Shaw_term</span><span class="p">(</span><span class="n">iscyclic_aliphatic</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">Lastovka_Shaw_Indefinite_Integral_Over_T</span><span class="p">(</span><span class="n">Tb</span><span class="p">,</span> <span class="n">MW</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">,</span> <span class="n">term</span><span class="p">)</span>
            <span class="o">-</span> <span class="n">Lastovka_Shaw_Indefinite_Integral_Over_T</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span> <span class="n">MW</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">,</span> <span class="n">term</span><span class="p">))</span>

 
<span class="k">def</span> <span class="nf">Lastovka_Shaw_Indefinite_Integral_Over_T</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">MW</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">,</span> <span class="n">term</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">similarity_variable</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">a</span>
    <span class="n">B11</span> <span class="o">=</span> <span class="mf">0.73917383</span>
    <span class="n">B12</span> <span class="o">=</span> <span class="mf">8.88308889</span>
    <span class="n">C11</span> <span class="o">=</span> <span class="mf">1188.28051</span>
    <span class="n">C12</span> <span class="o">=</span> <span class="mf">1813.04613</span>
    <span class="n">B21</span> <span class="o">=</span> <span class="mf">0.0483019</span>
    <span class="n">B22</span> <span class="o">=</span> <span class="mf">4.35656721</span>
    <span class="n">C21</span> <span class="o">=</span> <span class="mf">2897.01927</span>
    <span class="n">C22</span> <span class="o">=</span> <span class="mf">5987.80407</span>
    <span class="n">S</span> <span class="o">=</span> <span class="p">(</span><span class="n">term</span><span class="o">*</span><span class="n">clog</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">B11</span> <span class="o">-</span> <span class="n">B12</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">clog</span><span class="p">(</span><span class="n">cexp</span><span class="p">((</span><span class="o">-</span><span class="n">C11</span> <span class="o">-</span> <span class="n">C12</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span> 
        <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">B11</span><span class="o">*</span><span class="n">C11</span> <span class="o">-</span> <span class="n">B11</span><span class="o">*</span><span class="n">C12</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="n">B12</span><span class="o">*</span><span class="n">C11</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="n">B12</span><span class="o">*</span><span class="n">C12</span><span class="o">*</span><span class="n">a2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">cexp</span><span class="p">((</span><span class="o">-</span><span class="n">C11</span>
        <span class="o">-</span> <span class="n">C12</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">-</span> <span class="n">T</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">B11</span><span class="o">*</span><span class="n">C11</span> <span class="o">+</span> <span class="n">B11</span><span class="o">*</span><span class="n">C12</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="n">B12</span><span class="o">*</span><span class="n">C11</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="n">B12</span><span class="o">*</span><span class="n">C12</span><span class="o">*</span><span class="n">a2</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span>
    <span class="n">S</span> <span class="o">+=</span> <span class="p">((</span><span class="o">-</span><span class="n">B21</span> <span class="o">-</span> <span class="n">B22</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">clog</span><span class="p">(</span><span class="n">cexp</span><span class="p">((</span><span class="o">-</span><span class="n">C21</span> <span class="o">-</span> <span class="n">C22</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">B21</span><span class="o">*</span><span class="n">C21</span> <span class="o">-</span> <span class="n">B21</span><span class="o">*</span><span class="n">C22</span><span class="o">*</span><span class="n">a</span>
        <span class="o">-</span> <span class="n">B22</span><span class="o">*</span><span class="n">C21</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="n">B22</span><span class="o">*</span><span class="n">C22</span><span class="o">*</span><span class="n">a2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">cexp</span><span class="p">((</span><span class="o">-</span><span class="n">C21</span> <span class="o">-</span> <span class="n">C22</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">-</span> <span class="n">T</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">B21</span><span class="o">*</span><span class="n">C21</span>
        <span class="o">+</span> <span class="n">B21</span><span class="o">*</span><span class="n">C22</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="n">B22</span><span class="o">*</span><span class="n">C21</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="n">B22</span><span class="o">*</span><span class="n">C22</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span>
    <span class="c1"># There is a non-real component, but it is only a function of similariy </span>
    <span class="c1"># variable and so will always cancel out.</span>
    <span class="k">return</span> <span class="n">MW</span> <span class="o">*</span> <span class="n">S</span><span class="o">.</span><span class="n">real</span>

<div class="viewcode-block" id="TRCCn"><a class="viewcode-back" href="../../../properties/heat_capacity.html#thermosteam.properties.heat_capacity.TRCCn">[docs]</a><span class="nd">@Cn</span><span class="o">.</span><span class="n">g</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s2">&quot;[2]_&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">TRCCn</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">a0</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">,</span> <span class="n">a5</span><span class="p">,</span> <span class="n">a6</span><span class="p">,</span> <span class="n">a7</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The ideal gas heat capacity (Cn.g; J/mol/K) is given by:</span>

<span class="sd">    .. math::</span>
<span class="sd">        C_n = R\left(a_0 + (a_1/T^2) \exp(-a_2/T) + a_3 y^2</span>
<span class="sd">        + (a_4 - a_5/(T-a_7)^2 )y^j \right)</span>

<span class="sd">        y = \frac{T-a_7}{T+a_6} \text{ for } T &gt; a_7 \text{ otherwise } 0</span>

<span class="sd">    j is set to 8. Analytical integrals are available for this expression.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Calculate the heat capacity of Methane at 300 K:</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; f_Cng = TRCCn(4.0, 22350000, 2018, 32.767, -31.098, 1346090000, 1229, 473)</span>
<span class="sd">    &gt;&gt;&gt; f_Cng</span>
<span class="sd">    Functor: TRCCn(T, P=None) -&gt; Cn.g [J/mol/K]</span>
<span class="sd">     a0: 4</span>
<span class="sd">     a1: 2.235e+07</span>
<span class="sd">     a2: 2018</span>
<span class="sd">     a3: 32.767</span>
<span class="sd">     a4: -31.098</span>
<span class="sd">     a5: 1.3461e+09</span>
<span class="sd">     a6: 1229</span>
<span class="sd">     a7: 473</span>
<span class="sd">    &gt;&gt;&gt; f_Cng(300)</span>
<span class="sd">    35.73249522521754</span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">T</span> <span class="o">&lt;=</span> <span class="n">a7</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span> <span class="o">-</span> <span class="n">a7</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">T</span> <span class="o">+</span> <span class="n">a6</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="n">a0</span> <span class="o">+</span> <span class="p">(</span><span class="n">a1</span><span class="o">/</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a2</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">a3</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">a4</span> <span class="o">-</span> <span class="n">a5</span><span class="o">/</span><span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="n">a7</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mf">8.</span><span class="p">)</span></div>

 
<span class="k">def</span> <span class="nf">TRCCn_Indefinite_Integral</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">a0</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">,</span> <span class="n">a5</span><span class="p">,</span> <span class="n">a6</span><span class="p">,</span> <span class="n">a7</span><span class="p">):</span>
    <span class="n">first</span> <span class="o">=</span> <span class="n">a6</span> <span class="o">+</span> <span class="n">a7</span>    
    <span class="n">y</span> <span class="o">=</span> <span class="mf">0.</span> <span class="k">if</span> <span class="n">T</span> <span class="o">&lt;=</span> <span class="n">a7</span> <span class="k">else</span> <span class="p">(</span><span class="n">T</span> <span class="o">-</span> <span class="n">a7</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">T</span> <span class="o">+</span> <span class="n">a6</span><span class="p">)</span>
    <span class="n">y2</span> <span class="o">=</span> <span class="n">y</span><span class="o">*</span><span class="n">y</span>
    <span class="n">y4</span> <span class="o">=</span> <span class="n">y2</span><span class="o">*</span><span class="n">y2</span>
    <span class="k">if</span> <span class="n">T</span> <span class="o">&lt;=</span> <span class="n">a7</span><span class="p">:</span>
        <span class="n">h</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">second</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">a3</span> <span class="o">+</span> <span class="mf">8.</span><span class="o">*</span><span class="n">a4</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">third</span> <span class="o">=</span> <span class="p">(</span><span class="n">a3</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">y</span><span class="p">))</span> <span class="o">+</span> <span class="n">a4</span><span class="o">*</span><span class="p">(</span><span class="mf">7.</span> <span class="o">+</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">y</span><span class="p">)))</span><span class="o">*</span><span class="n">y</span>
        <span class="n">fourth</span> <span class="o">=</span> <span class="n">a4</span><span class="o">*</span><span class="p">(</span><span class="mf">3.</span><span class="o">*</span><span class="n">y2</span> <span class="o">+</span> <span class="mf">5.</span><span class="o">/</span><span class="mf">3.</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">y2</span> <span class="o">+</span> <span class="n">y4</span> <span class="o">+</span> <span class="mf">0.6</span><span class="o">*</span><span class="n">y4</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mf">3.</span><span class="o">*</span><span class="n">y4</span><span class="o">*</span><span class="n">y2</span><span class="p">)</span>
        <span class="n">fifth</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mf">7.</span><span class="o">*</span><span class="p">(</span><span class="n">a4</span> <span class="o">-</span> <span class="n">a5</span><span class="o">/</span><span class="p">((</span><span class="n">a6</span> <span class="o">+</span> <span class="n">a7</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">y4</span><span class="o">*</span><span class="n">y2</span><span class="o">*</span><span class="n">y</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">first</span><span class="o">*</span><span class="p">(</span><span class="n">second</span> <span class="o">+</span> <span class="n">third</span> <span class="o">+</span> <span class="n">fourth</span> <span class="o">+</span> <span class="n">fifth</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">a0</span> <span class="o">+</span> <span class="n">a1</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a2</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">a2</span><span class="o">*</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">h</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">T</span>

<span class="nd">@H</span><span class="o">.</span><span class="n">g</span>
<span class="k">def</span> <span class="nf">TRCCn_Integral</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">a0</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">,</span> <span class="n">a5</span><span class="p">,</span> <span class="n">a6</span><span class="p">,</span> <span class="n">a7</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">TRCCn_Indefinite_Integral</span><span class="p">(</span><span class="n">Tb</span><span class="p">,</span> <span class="n">a0</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">,</span> <span class="n">a5</span><span class="p">,</span> <span class="n">a6</span><span class="p">,</span> <span class="n">a7</span><span class="p">)</span>
            <span class="o">-</span> <span class="n">TRCCn_Indefinite_Integral</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span> <span class="n">a0</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">,</span> <span class="n">a5</span><span class="p">,</span> <span class="n">a6</span><span class="p">,</span> <span class="n">a7</span><span class="p">))</span>

 
<span class="k">def</span> <span class="nf">TRCCn_Over_T_Indefinite_Integral</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">a0</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">,</span> <span class="n">a5</span><span class="p">,</span> <span class="n">a6</span><span class="p">,</span> <span class="n">a7</span><span class="p">):</span>
    <span class="c1"># Possible optimizations: pre-cache as much as possible.</span>
    <span class="c1"># If this were replaced by a cache, much of this would not need to be computed.</span>
    <span class="n">y</span> <span class="o">=</span> <span class="mf">0.</span> <span class="k">if</span> <span class="n">T</span> <span class="o">&lt;=</span> <span class="n">a7</span> <span class="k">else</span> <span class="p">(</span><span class="n">T</span> <span class="o">-</span> <span class="n">a7</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">T</span> <span class="o">+</span> <span class="n">a6</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">T</span><span class="o">/</span><span class="p">(</span><span class="n">T</span> <span class="o">+</span> <span class="n">a6</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">a7</span> <span class="o">+</span> <span class="n">a6</span><span class="p">)</span><span class="o">/</span><span class="n">a7</span>
    <span class="k">if</span> <span class="n">T</span> <span class="o">&lt;=</span> <span class="n">a7</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">a72</span> <span class="o">=</span> <span class="n">a7</span><span class="o">*</span><span class="n">a7</span>
        <span class="n">a62</span> <span class="o">=</span> <span class="n">a6</span><span class="o">*</span><span class="n">a6</span>
        <span class="n">a7_a6</span> <span class="o">=</span> <span class="n">a7</span><span class="o">/</span><span class="n">a6</span> <span class="c1"># a7/a6</span>
        <span class="n">a7_a6_2</span> <span class="o">=</span> <span class="n">a7_a6</span><span class="o">*</span><span class="n">a7_a6</span>
        <span class="n">a7_a6_4</span> <span class="o">=</span> <span class="n">a7_a6_2</span><span class="o">*</span><span class="n">a7_a6_2</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="p">(</span><span class="n">a4</span><span class="o">*</span><span class="n">a72</span> <span class="o">-</span> <span class="n">a5</span><span class="p">)</span><span class="o">/</span><span class="n">a62</span> <span class="c1"># part of third, sum</span>
        <span class="n">first</span> <span class="o">=</span> <span class="p">(</span><span class="n">a3</span> <span class="o">+</span> <span class="p">((</span><span class="n">a4</span><span class="o">*</span><span class="n">a72</span> <span class="o">-</span> <span class="n">a5</span><span class="p">)</span><span class="o">/</span><span class="n">a62</span><span class="p">)</span><span class="o">*</span><span class="n">a7_a6_4</span><span class="p">)</span><span class="o">*</span><span class="n">a7_a6_2</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">second</span> <span class="o">=</span> <span class="p">(</span><span class="n">a3</span> <span class="o">+</span> <span class="n">a4</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">((</span><span class="n">T</span> <span class="o">+</span> <span class="n">a6</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">a6</span> <span class="o">+</span> <span class="n">a7</span><span class="p">))</span>
        <span class="n">fourth</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">a3</span><span class="o">/</span><span class="n">a6</span><span class="o">*</span><span class="p">(</span><span class="n">a6</span> <span class="o">+</span> <span class="n">a7</span><span class="p">)</span> <span class="o">+</span> <span class="n">a5</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">6</span><span class="o">/</span><span class="p">(</span><span class="mf">7.</span><span class="o">*</span><span class="n">a7</span><span class="o">*</span><span class="p">(</span><span class="n">a6</span> <span class="o">+</span> <span class="n">a7</span><span class="p">)))</span><span class="o">*</span><span class="n">y</span>
        <span class="n">third</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">x1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">a7_a6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">6</span><span class="o">-</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">a4</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="n">i</span><span class="o">/</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">first</span> <span class="o">+</span> <span class="n">second</span> <span class="o">+</span> <span class="n">third</span> <span class="o">+</span> <span class="n">fourth</span>
    <span class="k">return</span> <span class="n">a0</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">a1</span><span class="o">/</span><span class="p">(</span><span class="n">a2</span><span class="o">*</span><span class="n">a2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">a2</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a2</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">s</span>

<span class="nd">@S</span><span class="o">.</span><span class="n">g</span>
<span class="k">def</span> <span class="nf">TRCCn_Integral_Over_T</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">a0</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">,</span> <span class="n">a5</span><span class="p">,</span> <span class="n">a6</span><span class="p">,</span> <span class="n">a7</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="n">TRCCn_Over_T_Indefinite_Integral</span><span class="p">(</span><span class="n">Tb</span><span class="p">,</span> <span class="n">a0</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">,</span> <span class="n">a5</span><span class="p">,</span> <span class="n">a6</span><span class="p">,</span> <span class="n">a7</span><span class="p">)</span>
              <span class="o">-</span> <span class="n">TRCCn_Over_T_Indefinite_Integral</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span> <span class="n">a0</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">,</span> <span class="n">a5</span><span class="p">,</span> <span class="n">a6</span><span class="p">,</span> <span class="n">a7</span><span class="p">))</span>

<div class="viewcode-block" id="Poling"><a class="viewcode-back" href="../../../properties/heat_capacity.html#thermosteam.properties.heat_capacity.Poling">[docs]</a><span class="nd">@Cn</span><span class="o">.</span><span class="n">g</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s2">&quot;[3]_&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">Poling</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The ideal gas heat capacity (Cn.g; J/mol/K) is given by:</span>
<span class="sd">    </span>
<span class="sd">    .. math:: C_n = R*(a + bT + cT^2 + dT^3 + eT^4)</span>
<span class="sd">    </span>
<span class="sd">    The data is based on the Poling data bank.</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Compute the gas heat capacity of Methane at 300 K:</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; f_Cng = Poling(a=4.568, b=-0.008975, c=3.631e-05, d=-3.407e-08, e=1.091e-11)</span>
<span class="sd">    &gt;&gt;&gt; f_Cng</span>
<span class="sd">    Functor: Poling(T, P=None) -&gt; Cn.g [J/mol/K]</span>
<span class="sd">     a: 4.568</span>
<span class="sd">     b: -0.008975</span>
<span class="sd">     c: 3.631e-05</span>
<span class="sd">     d: -3.407e-08</span>
<span class="sd">     e: 1.091e-11</span>
<span class="sd">    &gt;&gt;&gt; f_Cng(300)</span>
<span class="sd">    35.85096123688382</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span> <span class="n">c</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">d</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">e</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span></div>

 
<span class="k">def</span> <span class="nf">Poling_Indefinite_Integral</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(((((</span><span class="mf">0.2</span><span class="o">*</span><span class="n">e</span><span class="p">)</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">d</span><span class="p">)</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span> <span class="n">c</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">T</span>

<span class="nd">@H</span><span class="o">.</span><span class="n">g</span>
<span class="k">def</span> <span class="nf">Poling_Integral</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="n">Poling_Indefinite_Integral</span><span class="p">(</span><span class="n">Tb</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
              <span class="o">-</span> <span class="n">Poling_Indefinite_Integral</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>

 
<span class="k">def</span> <span class="nf">Poling_Over_T_Indefinite_Integral</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">((((</span><span class="mf">0.25</span><span class="o">*</span><span class="n">e</span><span class="p">)</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span> <span class="n">d</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">c</span><span class="p">)</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">T</span>

<span class="nd">@S</span><span class="o">.</span><span class="n">g</span>
<span class="k">def</span> <span class="nf">Poling_Integral_Over_T</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="n">Poling_Over_T_Indefinite_Integral</span><span class="p">(</span><span class="n">Tb</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
              <span class="o">-</span> <span class="n">Poling_Over_T_Indefinite_Integral</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
              <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">Tb</span><span class="o">/</span><span class="n">Ta</span><span class="p">))</span>

<span class="c1"># Heat capacity gas methods</span>
<span class="n">TRCIG</span> <span class="o">=</span> <span class="s1">&#39;TRC Thermodynamics of Organic Compounds in the Gas State (1994)&#39;</span>
<span class="n">POLING</span> <span class="o">=</span> <span class="s1">&#39;Poling et al. (2001)&#39;</span>
<span class="n">POLING_CONST</span> <span class="o">=</span> <span class="s1">&#39;Poling et al. (2001) constant&#39;</span>
<span class="n">CRCSTD</span> <span class="o">=</span> <span class="s1">&#39;CRC Standard Thermodynamic Properties of Chemical Substances&#39;</span>
<span class="n">VDI_TABULAR</span> <span class="o">=</span> <span class="s1">&#39;VDI Heat Atlas&#39;</span>
<span class="n">LASTOVKA_SHAW</span> <span class="o">=</span> <span class="s1">&#39;Lastovka and Shaw (2013)&#39;</span>

<span class="n">TRCCn_Functors</span> <span class="o">=</span> <span class="p">(</span><span class="n">TRCCn</span><span class="p">,</span>
                  <span class="n">TRCCn_Integral</span><span class="p">,</span>
                  <span class="n">TRCCn_Integral_Over_T</span><span class="p">)</span>
<span class="n">Poling_Functors</span> <span class="o">=</span> <span class="p">(</span><span class="n">Poling</span><span class="p">,</span>
                   <span class="n">Poling_Integral</span><span class="p">,</span> 
                   <span class="n">Poling_Integral_Over_T</span><span class="p">)</span>


<span class="nd">@TDependentHandleBuilder</span><span class="p">(</span><span class="s1">&#39;Cn.g&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">heat_capacity_gas_handle</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">CAS</span><span class="p">,</span> <span class="n">MW</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">,</span> <span class="n">iscyclic_aliphatic</span><span class="p">):</span>
    <span class="n">add_model</span> <span class="o">=</span> <span class="n">handle</span><span class="o">.</span><span class="n">add_model</span>
    <span class="k">if</span> <span class="n">CAS</span> <span class="ow">in</span> <span class="n">_TRC_gas</span><span class="p">:</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">Tmin</span><span class="p">,</span> <span class="n">Tmax</span><span class="p">,</span> <span class="n">a0</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">,</span> <span class="n">a5</span><span class="p">,</span> <span class="n">a6</span><span class="p">,</span> <span class="n">a7</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">_TRC_gas</span><span class="p">[</span><span class="n">CAS</span><span class="p">]</span>
        <span class="n">funcs</span> <span class="o">=</span> <span class="n">CnHS</span><span class="p">(</span><span class="o">*</span><span class="n">TRCCn_Functors</span><span class="p">,</span> <span class="p">(</span><span class="n">a0</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">,</span> <span class="n">a5</span><span class="p">,</span> <span class="n">a6</span><span class="p">,</span> <span class="n">a7</span><span class="p">))</span>
        <span class="n">add_model</span><span class="p">(</span><span class="n">Tmin</span><span class="o">=</span><span class="n">Tmin</span><span class="p">,</span> <span class="n">Tmax</span><span class="o">=</span><span class="n">Tmax</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">TRCIG</span><span class="p">,</span> <span class="o">**</span><span class="n">funcs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">CAS</span> <span class="ow">in</span> <span class="n">_Poling</span><span class="p">:</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">Tmin</span><span class="p">,</span> <span class="n">Tmax</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">Cn_g</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">_Poling</span><span class="p">[</span><span class="n">CAS</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
            <span class="n">funcs</span> <span class="o">=</span> <span class="n">CnHS</span><span class="p">(</span><span class="o">*</span><span class="n">Poling_Functors</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
            <span class="n">add_model</span><span class="p">(</span><span class="n">Tmin</span><span class="o">=</span><span class="n">Tmin</span><span class="p">,</span> <span class="n">Tmax</span><span class="o">=</span><span class="n">Tmax</span><span class="p">,</span> <span class="o">**</span><span class="n">funcs</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">POLING</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">Cn_g</span><span class="p">):</span>
            <span class="n">add_model</span><span class="p">(</span><span class="n">Cn_g</span><span class="p">,</span> <span class="n">Tmin</span><span class="p">,</span> <span class="n">Tmax</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">POLING_CONST</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">CAS</span> <span class="ow">in</span> <span class="n">_CRC_standard</span><span class="p">:</span>
        <span class="n">Cn_g</span> <span class="o">=</span> <span class="n">_CRC_standard</span><span class="p">[</span><span class="n">CAS</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">Cn_g</span><span class="p">):</span>
            <span class="n">add_model</span><span class="p">(</span><span class="n">Cn_g</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">CRCSTD</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">MW</span> <span class="ow">and</span> <span class="n">similarity_variable</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">MW</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">,</span> <span class="n">iscyclic_aliphatic</span><span class="p">)</span>
        <span class="n">add_model</span><span class="p">(</span><span class="n">Lastovka_Shaw</span><span class="o">.</span><span class="n">from_args</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="n">LASTOVKA_SHAW</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">CAS</span> <span class="ow">in</span> <span class="n">VDI_saturation_dict</span><span class="p">:</span>
        <span class="c1"># NOTE: VDI data is for the saturation curve, i.e. at increasing</span>
        <span class="c1"># pressure; it is normally substantially higher than the ideal gas</span>
        <span class="c1"># value</span>
        <span class="n">Ts</span><span class="p">,</span> <span class="n">Cn_gs</span> <span class="o">=</span> <span class="n">VDI_tabular_data</span><span class="p">(</span><span class="n">CAS</span><span class="p">,</span> <span class="s1">&#39;Cp (g)&#39;</span><span class="p">)</span>
        <span class="n">add_model</span><span class="p">(</span><span class="n">InterpolatedTDependentModel</span><span class="p">(</span><span class="n">Ts</span><span class="p">,</span> <span class="n">Cn_gs</span><span class="p">,</span> <span class="n">Tmin</span><span class="o">=</span><span class="n">Ts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Tmax</span><span class="o">=</span><span class="n">Ts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="n">VDI_TABULAR</span><span class="p">))</span>
    
    
<span class="c1">### Heat capacities of liquids</span>

<div class="viewcode-block" id="Rowlinson_Poling"><a class="viewcode-back" href="../../../properties/heat_capacity.html#thermosteam.properties.heat_capacity.Rowlinson_Poling">[docs]</a><span class="nd">@Cn</span><span class="o">.</span><span class="n">l</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s2">&quot;[3]_&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">Rowlinson_Poling</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">ω</span><span class="p">,</span> <span class="n">Cn_g</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The heat capacity of a liquid is given by:</span>

<span class="sd">    .. math::</span>
<span class="sd">        \frac{Cn^{L} - Cn^{g}}{R} = 1.586 + \frac{0.49}{1-T_r} +</span>
<span class="sd">        \omega\left[ 4.2775 + \frac{6.3(1-T_r)^{1/3}}{T_r} + \frac{0.4355}{1-T_r}\right]</span>

<span class="sd">    This equation is not too accurate.</span>
<span class="sd">    Poling compared 212 substances, and found error at 298K larger than 10%</span>
<span class="sd">    for 18 of them, mostly associating. Of the other 194 compounds, AARD is 2.5%.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Compute the liquid heat capacity of methane at 100 K:</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; Cn_g = Poling(a=4.568, b=-0.008975, c=3.631e-05,</span>
<span class="sd">    ...               d=-3.407e-08, e=1.091e-11)</span>
<span class="sd">    &gt;&gt;&gt; f_Cnl = Rowlinson_Poling(Tc=190.564, ω=0.008, Cn_g=Cn_g)</span>
<span class="sd">    Functor: Rowlinson_Poling(T, P=None) -&gt; Cn.l [J/mol/K]</span>
<span class="sd">     Tc: 190.56 K</span>
<span class="sd">     ω: 0.008</span>
<span class="sd">     Cn_g: Poling(T, P=None) -&gt; J/mol/K</span>
<span class="sd">    &gt;&gt;&gt; f_Cnl(100)</span>
<span class="sd">    55.99104104081243</span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">Tr</span> <span class="o">=</span> <span class="n">T</span><span class="o">/</span><span class="n">Tc</span>
    <span class="k">return</span> <span class="n">Cn_g</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="mf">1.586</span> <span class="o">+</span> <span class="mf">0.49</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">Tr</span><span class="p">)</span> <span class="o">+</span> <span class="n">ω</span><span class="o">*</span><span class="p">(</span><span class="mf">4.2775</span> <span class="o">+</span> <span class="mf">6.3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Tr</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span><span class="o">/</span><span class="n">Tr</span> <span class="o">+</span> <span class="mf">0.4355</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">Tr</span><span class="p">)))</span></div>

<div class="viewcode-block" id="Rowlinson_Bondi"><a class="viewcode-back" href="../../../properties/heat_capacity.html#thermosteam.properties.heat_capacity.Rowlinson_Bondi">[docs]</a><span class="nd">@Cn</span><span class="o">.</span><span class="n">l</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s2">&quot;[3]_ [4]_ [5]_&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">Rowlinson_Bondi</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">ω</span><span class="p">,</span> <span class="n">Cn_g</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The heat capacity of a liquid is given by:</span>

<span class="sd">    .. math::</span>
<span class="sd">        \frac{Cn^L - Cn^{ig}}{R} = 1.45 + 0.45(1-T_r)^{-1} + 0.25\omega</span>
<span class="sd">        [17.11 + 25.2(1-T_r)^{1/3}T_r^{-1} + 1.742(1-T_r)^{-1}]</span>

<span class="sd">    Less accurate than `Rowlinson_Poling`.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; Cn_g = Poling(a=4.568, b=-0.008975, c=3.631e-05,</span>
<span class="sd">    ...               d=-3.407e-08, e=1.091e-11)</span>
<span class="sd">    &gt;&gt;&gt; f_Cnl = Rowlinson_Poling(Tc=190.564, ω=0.008,</span>
<span class="sd">    ...                          Cn_g=Cn_g)</span>
<span class="sd">    &gt;&gt;&gt; f_Cnl</span>
<span class="sd">    Functor: Rowlinson_Poling(T, P=None) -&gt; Cn.l [J/mol/K]</span>
<span class="sd">     Tc: 190.56 K</span>
<span class="sd">     ω: 0.008</span>
<span class="sd">     Cn_g: Poling(T, P=None) -&gt; J/mol/K</span>
<span class="sd">    &gt;&gt;&gt; f_Cnl(100)</span>
<span class="sd">    55.986088530998174</span>
<span class="sd">      </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">Tr</span> <span class="o">=</span> <span class="n">T</span><span class="o">/</span><span class="n">Tc</span>
    <span class="k">return</span> <span class="n">Cn_g</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="mf">1.45</span> <span class="o">+</span> <span class="mf">0.45</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">Tr</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">ω</span><span class="o">*</span><span class="p">(</span><span class="mf">17.11</span> <span class="o">+</span> <span class="mf">25.2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Tr</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span><span class="o">/</span><span class="n">Tr</span> <span class="o">+</span> <span class="mf">1.742</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">Tr</span><span class="p">)))</span></div>

<div class="viewcode-block" id="Dadgostar_Shaw"><a class="viewcode-back" href="../../../properties/heat_capacity.html#thermosteam.properties.heat_capacity.Dadgostar_Shaw">[docs]</a><span class="nd">@Cn</span><span class="o">.</span><span class="n">l</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s2">&quot;[6]_&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">Dadgostar_Shaw</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">MW</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The liquid heat capacity is given by:</span>

<span class="sd">    .. math::</span>
<span class="sd">        C_{p} = 24.5(a_{11}\alpha + a_{12}\alpha^2)+ (a_{21}\alpha</span>
<span class="sd">        + a_{22}\alpha^2)T +(a_{31}\alpha + a_{32}\alpha^2)T^2</span>
<span class="sd">        </span>
<span class="sd">        C_n = MW \cdot Cp</span>

<span class="sd">    Where :math:`\alpha` is the similarity variable. There are many restrictions on its use.</span>

<span class="sd">    Original model is in terms of J/g/K, but it has been modified to give molar heat capacity in J/mol/K.</span>

<span class="sd">    a11 = -0.3416; a12 = 2.2671; a21 = 0.1064; a22 = -0.3874l;</span>
<span class="sd">    a31 = -9.8231E-05; a32 = 4.182E-04</span>
<span class="sd">      </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">,</span> <span class="n">third</span> <span class="o">=</span> <span class="n">calculate_Dadgostar_Shaw_terms</span><span class="p">(</span><span class="n">MW</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">)</span>
    <span class="n">first</span> <span class="o">*=</span> <span class="mi">3</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="mf">151.8675</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mf">151.8675</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="mf">151.8675</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">first</span> <span class="o">+</span> <span class="n">second</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span> <span class="n">third</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">MW</span></div>

 
<span class="k">def</span> <span class="nf">calculate_Dadgostar_Shaw_terms</span><span class="p">(</span><span class="n">MW</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">similarity_variable</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">a</span>
    <span class="n">a11</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.3416</span>
    <span class="n">a12</span> <span class="o">=</span> <span class="mf">2.2671</span>
    <span class="n">a21</span> <span class="o">=</span> <span class="mf">0.1064</span>
    <span class="n">a22</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.3874</span>
    <span class="n">a31</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9.8231E-05</span>
    <span class="n">a32</span> <span class="o">=</span> <span class="mf">4.182E-04</span>
    <span class="c1"># Didn&#39;t seem to improve the comparison; sum of errors on some</span>
    <span class="c1"># points included went from 65.5  to 286.</span>
    <span class="c1"># Author probably used more precision in their calculation.</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">a11</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="n">a12</span><span class="o">*</span><span class="n">a2</span><span class="p">,</span>
            <span class="n">a21</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="n">a22</span><span class="o">*</span><span class="n">a2</span><span class="p">,</span>
            <span class="n">a31</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="n">a32</span><span class="o">*</span><span class="n">a2</span><span class="p">)</span>

 
<span class="k">def</span> <span class="nf">Dadgostar_Shaw_Indefinte_Integral</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">,</span> <span class="n">third</span><span class="p">):</span>
    <span class="n">T2</span> <span class="o">=</span> <span class="n">T</span><span class="o">*</span><span class="n">T</span>
    <span class="n">first</span> <span class="o">*=</span> <span class="mi">3</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="mf">151.8675</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mf">151.8675</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="mf">151.8675</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">T2</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="mf">3.</span><span class="o">*</span><span class="n">third</span> <span class="o">+</span> <span class="n">T2</span><span class="o">*</span><span class="mf">0.5</span><span class="o">*</span><span class="n">second</span> <span class="o">+</span> <span class="n">T</span><span class="o">*</span><span class="n">first</span>

<span class="nd">@H</span><span class="o">.</span><span class="n">l</span>
<span class="k">def</span> <span class="nf">Dadgostar_Shaw_Integral</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">MW</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">):</span>
    <span class="n">terms</span> <span class="o">=</span> <span class="n">calculate_Dadgostar_Shaw_terms</span><span class="p">(</span><span class="n">MW</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">MW</span><span class="o">*</span><span class="p">(</span><span class="n">Dadgostar_Shaw_Indefinte_Integral</span><span class="p">(</span><span class="n">Tb</span><span class="p">,</span> <span class="o">*</span><span class="n">terms</span><span class="p">)</span>
               <span class="o">-</span> <span class="n">Dadgostar_Shaw_Indefinte_Integral</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span> <span class="o">*</span><span class="n">terms</span><span class="p">))</span>

 
<span class="k">def</span> <span class="nf">Dadgostar_Shaw_Over_T_Indefinte_Integral</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">,</span> <span class="n">third</span><span class="p">):</span>
    <span class="n">first</span> <span class="o">*=</span> <span class="mi">3</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="mf">151.8675</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mf">151.8675</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="mf">151.8675</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="mf">0.5</span><span class="o">*</span><span class="n">third</span> <span class="o">+</span> <span class="n">T</span><span class="o">*</span><span class="n">second</span> <span class="o">+</span> <span class="n">first</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>

<span class="nd">@H</span><span class="o">.</span><span class="n">l</span>
<span class="k">def</span> <span class="nf">Dadgostar_Shaw_Over_T_Integral</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">MW</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">):</span>
    <span class="n">terms</span> <span class="o">=</span> <span class="n">calculate_Dadgostar_Shaw_terms</span><span class="p">(</span><span class="n">MW</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">MW</span><span class="o">*</span><span class="p">(</span><span class="n">Dadgostar_Shaw_Over_T_Indefinte_Integral</span><span class="p">(</span><span class="n">Tb</span><span class="p">,</span> <span class="o">*</span><span class="n">terms</span><span class="p">)</span>
               <span class="o">-</span> <span class="n">Dadgostar_Shaw_Over_T_Indefinte_Integral</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span> <span class="o">*</span><span class="n">terms</span><span class="p">))</span>

<span class="n">zabransky_dict_sat_s</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">zabransky_dict_sat_p</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">zabransky_dict_const_s</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">zabransky_dict_const_p</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">zabransky_dict_iso_s</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">zabransky_dict_iso_p</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># C means average heat capacity values, from less rigorous experiments</span>
<span class="c1"># sat means heat capacity along the saturation line</span>
<span class="c1"># p means constant-pressure values, </span>
<span class="c1"># second argument is whether or not it has a spline</span>
<span class="n">type_to_zabransky_dict</span> <span class="o">=</span> <span class="p">{(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span> <span class="n">zabransky_dict_const_s</span><span class="p">,</span> 
                          <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>   <span class="n">zabransky_dict_const_p</span><span class="p">,</span>
                          <span class="p">(</span><span class="s1">&#39;sat&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>  <span class="n">zabransky_dict_sat_s</span><span class="p">,</span>
                          <span class="p">(</span><span class="s1">&#39;sat&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span> <span class="n">zabransky_dict_sat_p</span><span class="p">,</span>
                          <span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>    <span class="n">zabransky_dict_iso_s</span><span class="p">,</span>
                          <span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>   <span class="n">zabransky_dict_iso_p</span><span class="p">}</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">read</span><span class="o">.</span><span class="n">folder</span><span class="p">,</span> <span class="s1">&#39;Zabransky.tsv&#39;</span><span class="p">),</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="nb">next</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">to_nums</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">))</span>
        <span class="p">(</span><span class="n">CAS</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">Type</span><span class="p">,</span> <span class="n">uncertainty</span><span class="p">,</span> <span class="n">Tmin</span><span class="p">,</span> <span class="n">Tmax</span><span class="p">,</span> <span class="n">a1s</span><span class="p">,</span> <span class="n">a2s</span><span class="p">,</span> <span class="n">a3s</span><span class="p">,</span> <span class="n">a4s</span><span class="p">,</span> <span class="n">a1p</span><span class="p">,</span> <span class="n">a2p</span><span class="p">,</span> <span class="n">a3p</span><span class="p">,</span> <span class="n">a4p</span><span class="p">,</span> <span class="n">a5p</span><span class="p">,</span> <span class="n">a6p</span><span class="p">,</span> <span class="n">Tc</span><span class="p">)</span> <span class="o">=</span> <span class="n">values</span>
        <span class="n">spline</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">a1s</span><span class="p">)</span> <span class="c1"># False if Quasypolynomial, True if spline</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">type_to_zabransky_dict</span><span class="p">[(</span><span class="n">Type</span><span class="p">,</span> <span class="n">spline</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">spline</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">CAS</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="n">CAS</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="n">a1s</span><span class="p">,</span> <span class="n">a2s</span><span class="p">,</span> <span class="n">a3s</span><span class="p">,</span> <span class="n">a4s</span><span class="p">,</span> <span class="n">Tmin</span><span class="p">,</span> <span class="n">Tmax</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="n">CAS</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">a1s</span><span class="p">,</span> <span class="n">a2s</span><span class="p">,</span> <span class="n">a3s</span><span class="p">,</span> <span class="n">a4s</span><span class="p">,</span> <span class="n">Tmin</span><span class="p">,</span> <span class="n">Tmax</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># No duplicates for quasipolynomials</span>
            <span class="n">d</span><span class="p">[</span><span class="n">CAS</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Tc</span><span class="p">,</span> <span class="n">a1p</span><span class="p">,</span> <span class="n">a2p</span><span class="p">,</span> <span class="n">a3p</span><span class="p">,</span> <span class="n">a4p</span><span class="p">,</span> <span class="n">a5p</span><span class="p">,</span> <span class="n">a6p</span><span class="p">,</span> <span class="n">Tmin</span><span class="p">,</span> <span class="n">Tmax</span><span class="p">)</span>

<div class="viewcode-block" id="Zabransky_Quasi_Polynomial"><a class="viewcode-back" href="../../../properties/heat_capacity.html#thermosteam.properties.heat_capacity.Zabransky_Quasi_Polynomial">[docs]</a><span class="nd">@Cn</span><span class="o">.</span><span class="n">l</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s2">&quot;[7]_&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">Zabransky_Quasi_Polynomial</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">,</span> <span class="n">a5</span><span class="p">,</span> <span class="n">a6</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The liquid heat capacity is given by:</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">        \frac{C_n}{R}=A_1\ln(1-T_r) + \frac{A_2}{1-T_r}</span>
<span class="sd">        + \sum_{j=0}^m A_{j+3} T_r^j</span>

<span class="sd">    Used only for isobaric heat capacities, not saturation heat capacities.</span>
<span class="sd">    Designed for reasonable extrapolation behavior caused by using the reduced</span>
<span class="sd">    critical temperature. Used by the authors of [1]_ when critical temperature</span>
<span class="sd">    was available for the fluid.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Tr</span> <span class="o">=</span> <span class="n">T</span><span class="o">/</span><span class="n">Tc</span>
    <span class="k">return</span> <span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="n">a1</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Tr</span><span class="p">)</span> <span class="o">+</span> <span class="n">a2</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Tr</span><span class="p">)</span> <span class="o">+</span> <span class="n">a3</span> <span class="o">+</span> <span class="n">a4</span><span class="o">*</span><span class="n">Tr</span> <span class="o">+</span> <span class="n">a5</span><span class="o">*</span><span class="n">Tr</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a6</span><span class="o">*</span><span class="n">Tr</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span></div>

 
<span class="k">def</span> <span class="nf">Zabransky_Quasi_Polynomial_Indefinte_Integral</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">,</span> <span class="n">a5</span><span class="p">,</span> <span class="n">a6</span><span class="p">):</span>
    <span class="n">Tc2</span> <span class="o">=</span> <span class="n">Tc</span><span class="o">*</span><span class="n">Tc</span>
    <span class="n">Tc3</span> <span class="o">=</span> <span class="n">Tc2</span><span class="o">*</span><span class="n">Tc</span>    
    <span class="n">term</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span> <span class="o">-</span> <span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">a6</span><span class="o">/</span><span class="p">(</span><span class="mf">4.</span><span class="o">*</span><span class="n">Tc3</span><span class="p">)</span> <span class="o">+</span> <span class="n">a5</span><span class="o">/</span><span class="p">(</span><span class="mf">3.</span><span class="o">*</span><span class="n">Tc2</span><span class="p">))</span> <span class="o">+</span> <span class="n">a4</span><span class="o">/</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">Tc</span><span class="p">))</span> <span class="o">-</span> <span class="n">a1</span> <span class="o">+</span> <span class="n">a3</span><span class="p">)</span> 
              <span class="o">+</span> <span class="n">T</span><span class="o">*</span><span class="n">a1</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="p">(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">a2</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">term</span><span class="p">))</span>

<span class="nd">@H</span><span class="o">.</span><span class="n">l</span>
<span class="k">def</span> <span class="nf">Zabransky_Quasi_Polynomial_Integral</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">,</span> <span class="n">a5</span><span class="p">,</span> <span class="n">a6</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">Zabransky_Quasi_Polynomial_Indefinte_Integral</span><span class="p">(</span><span class="n">Tb</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">,</span> <span class="n">a5</span><span class="p">,</span> <span class="n">a6</span><span class="p">)</span>
            <span class="o">-</span> <span class="n">Zabransky_Quasi_Polynomial_Indefinte_Integral</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">,</span> <span class="n">a5</span><span class="p">,</span> <span class="n">a6</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">Zabransky_Quasi_Polynomial_Over_T_Indefinte_Integral</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">,</span> <span class="n">a5</span><span class="p">,</span> <span class="n">a6</span><span class="p">):</span>
    <span class="n">Tc2</span> <span class="o">=</span> <span class="n">Tc</span><span class="o">*</span><span class="n">Tc</span>
    <span class="n">Tc3</span> <span class="o">=</span> <span class="n">Tc2</span><span class="o">*</span><span class="n">Tc</span>    
    <span class="n">term</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span> <span class="o">-</span> <span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">term</span> <span class="o">=</span> <span class="n">T</span> <span class="o">-</span> <span class="n">Tc</span>
    <span class="n">logT</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="n">a3</span><span class="o">*</span><span class="n">logT</span> <span class="o">-</span><span class="n">a1</span><span class="o">*</span><span class="n">polylog2</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="n">a2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">logT</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">term</span><span class="o">*</span><span class="n">term</span><span class="p">))</span>
              <span class="o">+</span> <span class="n">T</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">a6</span><span class="o">/</span><span class="p">(</span><span class="mf">3.</span><span class="o">*</span><span class="n">Tc3</span><span class="p">)</span> <span class="o">+</span> <span class="n">a5</span><span class="o">/</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">Tc2</span><span class="p">))</span> <span class="o">+</span> <span class="n">a4</span><span class="o">/</span><span class="n">Tc</span><span class="p">))</span>

<span class="nd">@S</span><span class="o">.</span><span class="n">l</span>
<span class="k">def</span> <span class="nf">Zabransky_Quasi_Polynomial_Over_T_Integral</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">,</span> <span class="n">a5</span><span class="p">,</span> <span class="n">a6</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">Zabransky_Quasi_Polynomial_Over_T_Indefinte_Integral</span><span class="p">(</span><span class="n">Tb</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">,</span> <span class="n">a5</span><span class="p">,</span> <span class="n">a6</span><span class="p">)</span>
            <span class="o">-</span> <span class="n">Zabransky_Quasi_Polynomial_Over_T_Indefinte_Integral</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">,</span> <span class="n">a5</span><span class="p">,</span> <span class="n">a6</span><span class="p">))</span>

<div class="viewcode-block" id="Zabransky_Cubic"><a class="viewcode-back" href="../../../properties/heat_capacity.html#thermosteam.properties.heat_capacity.Zabransky_Cubic">[docs]</a><span class="nd">@Cn</span><span class="o">.</span><span class="n">l</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;[7]_&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">Zabransky_Cubic</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The liquid heat capacity is given by:</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">        \frac{C}{R}=\sum_{j=0}^3 A_{j+1} \left(\frac{T}{100}\right)^j</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">T</span><span class="o">/</span><span class="mf">100.</span>
    <span class="k">return</span> <span class="n">R</span><span class="o">*</span><span class="p">(((</span><span class="n">a4</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span> <span class="n">a3</span><span class="p">)</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span> <span class="n">a2</span><span class="p">)</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span> <span class="n">a1</span><span class="p">)</span></div>

 
<span class="k">def</span> <span class="nf">Zabransky_Cubic_Indefinite_Integral</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">):</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">T</span><span class="o">/</span><span class="mf">100.</span>
    <span class="k">return</span> <span class="mf">100.</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">a4</span><span class="o">*</span><span class="mf">0.25</span> <span class="o">+</span> <span class="n">a3</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span> <span class="o">+</span> <span class="n">a2</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> <span class="n">a1</span><span class="p">)</span>

<span class="nd">@H</span><span class="o">.</span><span class="n">l</span>
<span class="k">def</span> <span class="nf">Zabransky_Cubic_Integral</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">Zabransky_Cubic_Indefinite_Integral</span><span class="p">(</span><span class="n">Tb</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">)</span>
            <span class="o">-</span> <span class="n">Zabransky_Cubic_Indefinite_Integral</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">))</span>

 
<span class="k">def</span> <span class="nf">Zabransky_Cubic_Over_T_Indefinite_Integral</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">):</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">T</span><span class="o">/</span><span class="mf">100.</span>
    <span class="k">return</span> <span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">a4</span><span class="o">/</span><span class="mf">3.</span> <span class="o">+</span> <span class="n">a3</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span> <span class="o">+</span> <span class="n">a2</span><span class="p">)</span> <span class="o">+</span> <span class="n">a1</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">T</span><span class="p">))</span>

<span class="nd">@S</span><span class="o">.</span><span class="n">l</span>
<span class="k">def</span> <span class="nf">Zabransky_Cubic_Over_T_Integral</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">Zabransky_Cubic_Over_T_Indefinite_Integral</span><span class="p">(</span><span class="n">Tb</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">)</span>
            <span class="o">-</span> <span class="n">Zabransky_Cubic_Over_T_Indefinite_Integral</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">))</span>
    

<span class="c1"># Heat capacity liquid methods:</span>
<span class="n">ZABRANSKY_SPLINE</span> <span class="o">=</span> <span class="s1">&#39;Zabransky spline, averaged heat capacity&#39;</span>
<span class="n">ZABRANSKY_QUASIPOLYNOMIAL</span> <span class="o">=</span> <span class="s1">&#39;Zabransky quasipolynomial, averaged heat capacity&#39;</span>
<span class="n">ZABRANSKY_SPLINE_C</span> <span class="o">=</span> <span class="s1">&#39;Zabransky spline, constant-pressure&#39;</span>
<span class="n">ZABRANSKY_QUASIPOLYNOMIAL_C</span> <span class="o">=</span> <span class="s1">&#39;Zabransky quasipolynomial, constant-pressure&#39;</span>
<span class="n">ZABRANSKY_SPLINE_SAT</span> <span class="o">=</span> <span class="s1">&#39;Zabransky spline, saturation&#39;</span>
<span class="n">ZABRANSKY_QUASIPOLYNOMIAL_SAT</span> <span class="o">=</span> <span class="s1">&#39;Zabransky quasipolynomial, saturation&#39;</span>
<span class="n">ROWLINSON_POLING</span> <span class="o">=</span> <span class="s1">&#39;Rowlinson and Poling (2001)&#39;</span>
<span class="n">ROWLINSON_BONDI</span> <span class="o">=</span> <span class="s1">&#39;Rowlinson and Bondi (1969)&#39;</span>
<span class="n">DADGOSTAR_SHAW</span> <span class="o">=</span> <span class="s1">&#39;Dadgostar and Shaw (2011)&#39;</span>

<span class="n">Zabransky_Cubic_Functors</span> <span class="o">=</span> <span class="p">(</span><span class="n">Zabransky_Cubic</span><span class="p">,</span>
                            <span class="n">Zabransky_Cubic_Integral</span><span class="p">,</span>
                            <span class="n">Zabransky_Cubic_Over_T_Integral</span><span class="p">)</span>
<span class="n">Zabransky_Quasi_Polynomial_Functors</span> <span class="o">=</span> <span class="p">(</span><span class="n">Zabransky_Quasi_Polynomial</span><span class="p">,</span>
                                    <span class="n">Zabransky_Quasi_Polynomial_Integral</span><span class="p">,</span> 
                                    <span class="n">Zabransky_Quasi_Polynomial_Over_T_Integral</span><span class="p">)</span>
<span class="n">Dadgostar_Shaw_Functors</span> <span class="o">=</span> <span class="p">(</span><span class="n">Dadgostar_Shaw</span><span class="p">,</span>
                           <span class="n">Dadgostar_Shaw_Integral</span><span class="p">,</span>
                           <span class="n">Dadgostar_Shaw_Over_T_Integral</span><span class="p">)</span>

<span class="n">zabransky_model_data</span> <span class="o">=</span> <span class="p">((</span><span class="n">ZABRANSKY_SPLINE</span><span class="p">,</span>
                         <span class="n">zabransky_dict_const_s</span><span class="p">,</span>
                         <span class="n">Zabransky_Cubic_Functors</span><span class="p">),</span>
                        <span class="p">(</span><span class="n">ZABRANSKY_QUASIPOLYNOMIAL</span><span class="p">,</span>
                         <span class="n">zabransky_dict_const_p</span><span class="p">,</span>
                         <span class="n">Zabransky_Quasi_Polynomial_Functors</span><span class="p">),</span>
                        <span class="p">(</span><span class="n">ZABRANSKY_SPLINE_C</span><span class="p">,</span>
                         <span class="n">zabransky_dict_iso_s</span><span class="p">,</span> 
                         <span class="n">Zabransky_Cubic_Functors</span><span class="p">),</span>
                        <span class="p">(</span><span class="n">ZABRANSKY_QUASIPOLYNOMIAL_C</span><span class="p">,</span> 
                         <span class="n">zabransky_dict_iso_p</span><span class="p">,</span>
                         <span class="n">Zabransky_Quasi_Polynomial_Functors</span><span class="p">),</span>
                        <span class="p">(</span><span class="n">ZABRANSKY_SPLINE_SAT</span><span class="p">,</span>
                         <span class="n">zabransky_dict_sat_s</span><span class="p">,</span>
                         <span class="n">Zabransky_Cubic_Functors</span><span class="p">),</span>
                        <span class="p">(</span><span class="n">ZABRANSKY_QUASIPOLYNOMIAL_SAT</span><span class="p">,</span> 
                         <span class="n">zabransky_dict_sat_p</span><span class="p">,</span>
                         <span class="n">Zabransky_Quasi_Polynomial_Functors</span><span class="p">))</span>

<span class="n">zabransky_model_builders</span> <span class="o">=</span> <span class="p">[</span><span class="n">ZabranskyModelBuilder</span><span class="p">(</span><span class="o">*</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">zabransky_model_data</span><span class="p">]</span>
<span class="n">zabransky_model_builders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">many</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">zabransky_model_builders</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">many</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">zabransky_model_builders</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">many</span> <span class="o">=</span> <span class="kc">True</span>

<span class="nd">@TDependentHandleBuilder</span><span class="p">(</span><span class="s1">&#39;Cn.l&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">heat_capacity_liquid_handle</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">CAS</span><span class="p">,</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">MW</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">,</span> <span class="n">Cn</span><span class="p">):</span>
    <span class="n">Cn_g</span> <span class="o">=</span> <span class="n">Cn</span><span class="o">.</span><span class="n">g</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">zabransky_model_builders</span><span class="p">:</span> <span class="n">i</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="n">CAS</span><span class="p">,</span> <span class="n">handle</span><span class="o">.</span><span class="n">models</span><span class="p">)</span>        
    <span class="n">add_model</span> <span class="o">=</span> <span class="n">handle</span><span class="o">.</span><span class="n">add_model</span>
    <span class="k">if</span> <span class="n">CAS</span> <span class="ow">in</span> <span class="n">VDI_saturation_dict</span><span class="p">:</span>
        <span class="c1"># NOTE: VDI data is for the saturation curve, i.e. at increasing</span>
        <span class="c1"># pressure; it is normally substantially higher than the ideal gas</span>
        <span class="c1"># value</span>
        <span class="n">Ts</span><span class="p">,</span> <span class="n">Cn_ls</span> <span class="o">=</span> <span class="n">VDI_tabular_data</span><span class="p">(</span><span class="n">CAS</span><span class="p">,</span> <span class="s1">&#39;Cp (l)&#39;</span><span class="p">)</span>
        <span class="n">add_model</span><span class="p">(</span><span class="n">InterpolatedTDependentModel</span><span class="p">(</span><span class="n">Ts</span><span class="p">,</span> <span class="n">Cn_ls</span><span class="p">,</span> <span class="n">Ts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Ts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="n">VDI_TABULAR</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">Tc</span> <span class="ow">and</span> <span class="n">omega</span> <span class="ow">and</span> <span class="n">Cn_g</span><span class="p">:</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">Tc</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">Cn_g</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="n">Tc</span><span class="p">)</span>
        <span class="n">add_model</span><span class="p">(</span><span class="n">Rowlinson_Bondi</span><span class="o">.</span><span class="n">from_args</span><span class="p">(</span><span class="n">args</span><span class="p">),</span> <span class="n">Tmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Tmax</span><span class="o">=</span><span class="n">Tc</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">ROWLINSON_BONDI</span><span class="p">)</span>
        <span class="n">add_model</span><span class="p">(</span><span class="n">Rowlinson_Poling</span><span class="o">.</span><span class="n">from_args</span><span class="p">(</span><span class="n">args</span><span class="p">),</span><span class="n">Tmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Tmax</span><span class="o">=</span><span class="n">Tc</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">ROWLINSON_POLING</span><span class="p">)</span>
    <span class="c1"># Other</span>
    <span class="k">if</span> <span class="n">MW</span> <span class="ow">and</span> <span class="n">similarity_variable</span><span class="p">:</span>
        <span class="n">add_model</span><span class="p">(</span><span class="n">CnHSModel</span><span class="p">(</span><span class="o">*</span><span class="n">Dadgostar_Shaw_Functors</span><span class="p">,</span>
                               <span class="n">data</span><span class="o">=</span><span class="p">(</span><span class="n">MW</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">),</span>
                               <span class="n">name</span><span class="o">=</span><span class="n">DADGOSTAR_SHAW</span><span class="p">))</span>
    <span class="c1"># Constant models</span>
    <span class="k">if</span> <span class="n">CAS</span> <span class="ow">in</span> <span class="n">_Poling</span><span class="p">:</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">Tmin</span><span class="p">,</span> <span class="n">Tmax</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">Cn_g</span><span class="p">,</span> <span class="n">Cn_l</span> <span class="o">=</span> <span class="n">_Poling</span><span class="p">[</span><span class="n">CAS</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">Cn_g</span><span class="p">):</span>
            <span class="n">add_model</span><span class="p">(</span><span class="n">Cn_l</span><span class="p">,</span> <span class="n">Tmin</span><span class="p">,</span> <span class="n">Tmax</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">POLING_CONST</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">CAS</span> <span class="ow">in</span> <span class="n">_CRC_standard</span><span class="p">:</span>
        <span class="n">Cn_l</span> <span class="o">=</span> <span class="n">_CRC_standard</span><span class="p">[</span><span class="n">CAS</span><span class="p">][</span><span class="o">-</span><span class="mi">5</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">Cn_l</span><span class="p">):</span>
            <span class="n">add_model</span><span class="p">(</span><span class="n">Cn_l</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">CRCSTD</span><span class="p">)</span>

<span class="c1"># %% Heat Capacity Solid</span>

<div class="viewcode-block" id="Lastovka_Solid"><a class="viewcode-back" href="../../../properties/heat_capacity.html#thermosteam.properties.heat_capacity.Lastovka_Solid">[docs]</a><span class="nd">@Cn</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s2">&quot;[8]_&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">Lastovka_Solid</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">,</span> <span class="n">MW</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The solid heat capacity is given by:</span>

<span class="sd">    .. math::</span>
<span class="sd">        C_p = 3(A_1\alpha + A_2\alpha^2)R\left(\frac{\theta}{T}\right)^2</span>
<span class="sd">        \frac{\exp(\theta/T)}{[\exp(\theta/T)-1]^2}</span>
<span class="sd">        + (C_1\alpha + C_2\alpha^2)T + (D_1\alpha + D_2\alpha^2)T^2</span>
<span class="sd">    </span>
<span class="sd">    Many restrictions on its use. Trained on data with MW from 12.24 g/mol</span>
<span class="sd">    to 402.4 g/mol, C mass fractions from 61.3% to 95.2%,</span>
<span class="sd">    H mass fractions from 3.73% to 15.2%, N mass fractions from 0 to 15.4%,</span>
<span class="sd">    O mass fractions from 0 to 18.8%, and S mass fractions from 0 to 29.6%.</span>
<span class="sd">    Recommended for organic compounds with low mass fractions of hetero-atoms</span>
<span class="sd">    and especially when molar mass exceeds 200 g/mol. This model does not show</span>
<span class="sd">    and effects of phase transition but should not be used passed the triple</span>
<span class="sd">    point.</span>
<span class="sd">    </span>
<span class="sd">    Original model is in terms of J/g/K, but it has been translated to J/mol/K.</span>
<span class="sd">    </span>
<span class="sd">    A1 = 0.013183; A2 = 0.249381; theta = 151.8675; C1 = 0.026526;</span>
<span class="sd">    C2 = -0.024942; D1 = 0.000025; D2 = -0.000123.</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Calculate the solid heat capacity of Ethanol at 150 K:</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; f = Lastovka_Solid(similarity_variable=0.19536150996213458,</span>
<span class="sd">    ...                    MW=46.06844)</span>
<span class="sd">    &gt;&gt;&gt; f</span>
<span class="sd">    Functor: Lastovka_Solid(T, P=None) -&gt; Cn.s [J/mol/K]</span>
<span class="sd">     similarity_variable: 0.19536</span>
<span class="sd">     MW: 46.068 g/mol</span>
<span class="sd">    &gt;&gt;&gt; f(150)</span>
<span class="sd">    42.196379547807</span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">A1</span> <span class="o">=</span> <span class="mf">0.013183</span>
    <span class="n">A2</span> <span class="o">=</span> <span class="mf">0.249381</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="mf">151.8675</span>
    <span class="n">C1</span> <span class="o">=</span> <span class="mf">0.026526</span>
    <span class="n">C2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.024942</span>
    <span class="n">D1</span> <span class="o">=</span> <span class="mf">0.000025</span>
    <span class="n">D2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.000123</span>
    <span class="n">sim2</span> <span class="o">=</span> <span class="n">similarity_variable</span><span class="o">*</span><span class="n">similarity_variable</span>
    <span class="k">return</span> <span class="n">MW</span> <span class="o">*</span> <span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">A1</span><span class="o">*</span><span class="n">similarity_variable</span> <span class="o">+</span> <span class="n">A2</span><span class="o">*</span><span class="n">sim2</span><span class="p">)</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="n">theta</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
                 <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="n">theta</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">theta</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
                 <span class="o">+</span> <span class="p">(</span><span class="n">C1</span><span class="o">*</span><span class="n">similarity_variable</span> <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">sim2</span><span class="p">)</span><span class="o">*</span><span class="n">T</span>
                 <span class="o">+</span> <span class="p">(</span><span class="n">D1</span><span class="o">*</span><span class="n">similarity_variable</span> <span class="o">+</span> <span class="n">D2</span><span class="o">*</span><span class="n">sim2</span><span class="p">)</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span></div>

 
<span class="k">def</span> <span class="nf">Lastovka_Solid_Indefinite_Integral</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">,</span> <span class="n">MW</span><span class="p">):</span>
    <span class="n">A1</span> <span class="o">=</span> <span class="mf">0.013183</span>
    <span class="n">A2</span> <span class="o">=</span> <span class="mf">0.249381</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="mf">151.8675</span>
    <span class="n">C1</span> <span class="o">=</span> <span class="mf">0.026526</span>
    <span class="n">C2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.024942</span>
    <span class="n">D1</span> <span class="o">=</span> <span class="mf">0.000025</span>
    <span class="n">D2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.000123</span>
    <span class="n">sim2</span> <span class="o">=</span> <span class="n">similarity_variable</span><span class="o">*</span><span class="n">similarity_variable</span>
    <span class="k">return</span> <span class="n">MW</span> <span class="o">*</span> <span class="p">(</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">D1</span><span class="o">*</span><span class="n">similarity_variable</span><span class="o">/</span><span class="mf">3.</span> 
        <span class="o">+</span> <span class="n">D2</span><span class="o">*</span><span class="n">sim2</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span> <span class="o">+</span> <span class="n">T</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="p">(</span><span class="n">C1</span><span class="o">*</span><span class="n">similarity_variable</span> 
        <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">sim2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
        <span class="o">+</span> <span class="mf">3.</span> <span class="o">*</span> <span class="p">(</span><span class="n">A1</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">similarity_variable</span><span class="o">*</span><span class="n">theta</span>
        <span class="o">+</span> <span class="n">A2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">sim2</span><span class="o">*</span><span class="n">theta</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">theta</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">))</span>

<span class="nd">@H</span><span class="o">.</span><span class="n">s</span>
<span class="k">def</span> <span class="nf">Lastovka_Solid_Integral</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">,</span> <span class="n">MW</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">Lastovka_Solid_Indefinite_Integral</span><span class="p">(</span><span class="n">Tb</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">,</span> <span class="n">MW</span><span class="p">)</span>
            <span class="o">-</span> <span class="n">Lastovka_Solid_Indefinite_Integral</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">,</span> <span class="n">MW</span><span class="p">))</span>

 
<span class="k">def</span> <span class="nf">Lastovka_Solid_Over_T_Indefinite_Integral</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">,</span> <span class="n">MW</span><span class="p">):</span>
    <span class="n">A1</span> <span class="o">=</span> <span class="mf">0.013183</span>
    <span class="n">A2</span> <span class="o">=</span> <span class="mf">0.249381</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="mf">151.8675</span>
    <span class="n">C1</span> <span class="o">=</span> <span class="mf">0.026526</span>
    <span class="n">C2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.024942</span>
    <span class="n">D1</span> <span class="o">=</span> <span class="mf">0.000025</span>
    <span class="n">D2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.000123</span>
    <span class="n">sim2</span> <span class="o">=</span> <span class="n">similarity_variable</span><span class="o">*</span><span class="n">similarity_variable</span>
    <span class="n">exp_theta_T</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">theta</span><span class="o">/</span><span class="n">T</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">MW</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">3.</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">similarity_variable</span><span class="o">*</span><span class="p">(</span><span class="n">A1</span> <span class="o">+</span> <span class="n">A2</span><span class="o">*</span><span class="n">similarity_variable</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">exp_theta_T</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span> 
                 <span class="o">+</span> <span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">D1</span><span class="o">*</span><span class="n">similarity_variable</span> <span class="o">+</span> <span class="n">D2</span><span class="o">*</span><span class="n">sim2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.</span>
                 <span class="o">+</span> <span class="n">T</span><span class="o">*</span><span class="p">(</span><span class="n">C1</span><span class="o">*</span><span class="n">similarity_variable</span> <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">sim2</span><span class="p">)</span>
                 <span class="o">+</span> <span class="p">(</span><span class="mf">3.</span><span class="o">*</span><span class="n">A1</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">similarity_variable</span><span class="o">*</span><span class="n">theta</span> 
                    <span class="o">+</span> <span class="mf">3.</span><span class="o">*</span><span class="n">A2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">sim2</span><span class="o">*</span><span class="n">theta</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">exp_theta_T</span> <span class="o">-</span> <span class="n">T</span><span class="p">)</span> 
                 <span class="o">+</span> <span class="p">(</span><span class="mf">3.</span><span class="o">*</span><span class="n">A1</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">similarity_variable</span><span class="o">*</span><span class="n">theta</span> 
                    <span class="o">+</span> <span class="mf">3.</span><span class="o">*</span><span class="n">A2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">sim2</span><span class="o">*</span><span class="n">theta</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span>
 
<span class="nd">@S</span><span class="o">.</span><span class="n">s</span>
<span class="k">def</span> <span class="nf">Lastovka_Solid_Over_T_Integral</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">,</span> <span class="n">MW</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">Lastovka_Solid_Over_T_Indefinite_Integral</span><span class="p">(</span><span class="n">Tb</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">,</span> <span class="n">MW</span><span class="p">)</span>
            <span class="o">-</span> <span class="n">Lastovka_Solid_Over_T_Indefinite_Integral</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">,</span> <span class="n">MW</span><span class="p">))</span>
    
    
<div class="viewcode-block" id="Perry_151"><a class="viewcode-back" href="../../../properties/heat_capacity.html#thermosteam.properties.heat_capacity.Perry_151">[docs]</a><span class="nd">@Cn</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="s1">&#39;[9]_&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">Perry_151</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    </span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The solid heat capacity is given by:</span>
<span class="sd">    </span>
<span class="sd">    .. math:: C_n = 4.184 (a + bT + \frac{c}{T^2} + dT^2)</span>
<span class="sd">    </span>
<span class="sd">    Coefficients are listed in section 2, table 151 of [9]_. Note that the original model was in a Calorie basis, but has been translated to Joules.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span> <span class="n">c</span><span class="o">/</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">d</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">calorie</span></div>

<span class="nd">@H</span><span class="o">.</span><span class="n">s</span>
<span class="k">def</span> <span class="nf">Perry_151_Integral</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
    <span class="n">H1</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">Ta</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">Ta</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">d</span><span class="o">/</span><span class="n">Ta</span> <span class="o">+</span> <span class="n">c</span><span class="o">*</span><span class="n">Ta</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span>
    <span class="n">H2</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">Tb</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">Tb</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">d</span><span class="o">/</span><span class="n">Tb</span> <span class="o">+</span> <span class="n">c</span><span class="o">*</span><span class="n">Tb</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">H2</span> <span class="o">-</span> <span class="n">H1</span><span class="p">)</span><span class="o">*</span><span class="n">calorie</span>

<span class="nd">@S</span><span class="o">.</span><span class="n">s</span>
<span class="k">def</span> <span class="nf">Perry_151_Over_T_Integral</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
    <span class="n">S1</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">Ta</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">Ta</span> <span class="o">-</span> <span class="n">d</span><span class="o">/</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">Ta</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">Ta</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">S2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">Tb</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">Tb</span> <span class="o">-</span> <span class="n">d</span><span class="o">/</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">Tb</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">Tb</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">S2</span> <span class="o">-</span> <span class="n">S1</span><span class="p">)</span><span class="o">*</span><span class="n">calorie</span>

<span class="n">Lastovka_Solid_Functors</span> <span class="o">=</span> <span class="p">(</span><span class="n">Lastovka_Solid</span><span class="p">,</span> <span class="n">Lastovka_Solid_Integral</span><span class="p">,</span> <span class="n">Lastovka_Solid_Over_T_Integral</span><span class="p">)</span>
<span class="n">Perry_151_Functors</span> <span class="o">=</span> <span class="p">(</span><span class="n">Perry_151</span><span class="p">,</span> <span class="n">Perry_151_Integral</span><span class="p">,</span> <span class="n">Perry_151_Over_T_Integral</span><span class="p">)</span>

<span class="c1"># Heat capacity solid methods</span>
<span class="n">LASTOVKA_S</span> <span class="o">=</span> <span class="s1">&#39;Lastovka, Fulem, Becerra and Shaw (2008)&#39;</span>
<span class="n">PERRY151</span> <span class="o">=</span> <span class="s2">&quot;Perry&#39;s Table 2-151&quot;</span>

<span class="nd">@TDependentHandleBuilder</span><span class="p">(</span><span class="s1">&#39;Cn.s&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">heat_capacity_solid_handle</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">CAS</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">,</span> <span class="n">MW</span><span class="p">):</span>
    <span class="n">Tmin</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">Tmax</span> <span class="o">=</span> <span class="mi">2000</span>
    <span class="n">add_model</span> <span class="o">=</span> <span class="n">handle</span><span class="o">.</span><span class="n">add_model</span>
    <span class="k">if</span> <span class="n">CAS</span> <span class="ow">in</span> <span class="n">_PerryI</span><span class="p">:</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="n">_PerryI</span><span class="p">[</span><span class="n">CAS</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;c&#39;</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span>
            <span class="n">Tmin</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;Tmin&#39;</span><span class="p">]</span>
            <span class="n">Tmax</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;Tmax&#39;</span><span class="p">]</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;Const&#39;</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;Lin&#39;</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;Quad&#39;</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;Quadinv&#39;</span><span class="p">])</span>
            <span class="n">add_model</span><span class="p">(</span><span class="n">CnHSModel</span><span class="p">(</span><span class="o">*</span><span class="n">Perry_151_Functors</span><span class="p">,</span> <span class="n">data</span><span class="p">),</span> <span class="n">Tmin</span><span class="p">,</span> <span class="n">Tmax</span><span class="p">,</span>
                      <span class="n">name</span><span class="o">=</span><span class="n">PERRY151</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">CAS</span> <span class="ow">in</span> <span class="n">_CRC_standard</span><span class="p">:</span>
        <span class="n">Cnc</span> <span class="o">=</span> <span class="n">_CRC_standard</span><span class="p">[</span><span class="n">CAS</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">Cnc</span><span class="p">):</span>
            <span class="n">add_model</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">Cnc</span><span class="p">),</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">350</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">similarity_variable</span> <span class="ow">and</span> <span class="n">MW</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">similarity_variable</span><span class="p">,</span> <span class="n">MW</span><span class="p">)</span>
        <span class="n">add_model</span><span class="p">(</span><span class="n">CnHSModel</span><span class="p">(</span><span class="o">*</span><span class="n">Lastovka_Solid_Functors</span><span class="p">,</span> <span class="n">data</span><span class="p">),</span> <span class="n">Tmin</span><span class="p">,</span> <span class="n">Tmax</span><span class="p">,</span>
                  <span class="n">name</span><span class="o">=</span><span class="n">LASTOVKA_S</span><span class="p">)</span>

<span class="n">heat_capacity_handle</span> <span class="o">=</span> <span class="n">PhaseTHandleBuilder</span><span class="p">(</span><span class="s1">&#39;Cn&#39;</span><span class="p">,</span> <span class="n">heat_capacity_solid_handle</span><span class="p">,</span> <span class="n">heat_capacity_liquid_handle</span><span class="p">,</span> <span class="n">heat_capacity_gas_handle</span><span class="p">)</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Yoel Cortes-Pena

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>