{%- macro curlies(item) -%}
{{ "{" }}{{ item }}{{ "}" }}
{%- endmacro -%}
{# --------------------------------------------------------------------------------#}
{%- macro href(url, text) -%}
\href{{ "{" }}{{ url|replace("#", "\\#")|replace("%", "\\%")|replace("_", "\\_") }}{{ "}" }}{{ curlies(text) }}
{%- endmacro -%}
{# --------------------------------------------------------------------------------#}
{%- macro label(text) -%}
\label{{ "{" }}{{ text }}{{ "}" }}
{%- endmacro -%}
{# --------------------------------------------------------------------------------#}
{%- macro write_step(index, from, content) -%}
\multirow{3}{*}{\parbox{1.3cm}{ {{ index }}
    {% if from != "" %}
{\scriptsize from \hyperref[{{ from.lower() }}]{{ curlies(from) }} }
    {% endif %}
} }
& {\small Description} &
\begin{minipage}[t]{13cm}{\scriptsize
{{ content.description }}
\vspace{\dp0}
} \end{minipage} \\ \cdashline{2-3}
& {\small Test Data} &
    {% if content.test_data %}
\begin{minipage}[t]{13cm}{\scriptsize
{{ content.test_data }}
\vspace{\dp0}
} \end{minipage}
    {% endif %}
\\ \cdashline{2-3}
    {% if content.example_code %}
& Example Code &
\begin{minipage}[t]{13cm}{\footnotesize
{{ content.example_code }}
\vspace{\dp0}
} \end{minipage} \\ \cline{2-3}
    {% endif %}
& {\small Expected Result} &
    {% if content.expected_result %}
\begin{minipage}[t]{13cm}{\scriptsize
{{ content.expected_result }}
\vspace{\dp0}
} \end{minipage}
    {% endif %}
\\ \hdashline
{%- endmacro -%}
{# --------------------------------------------------------------------------------#}

% generated from JIRA project {{ metadata.project }}
% using template at {{ metadata.template }}.
% Collecting ATM data from folder: "{{ metadata.folder }}"
% using docsteady version {{ metadata.docsteady_version }}
% Please do not edit -- update information in Jira instead

\section{Test Cases Summary}\label{test-cases-summary}

\begin{longtable}[]{p{3cm}p{13cm}}
\toprule
Test Id & Test Name\tabularnewline
\midrule
\endhead
{% for testcase in testcases %}
    \hyperref[{{ testcase.key.lower() }}]{{ curlies(testcase.key) }} &
    {{ href(testcase.jira_url, testcase.name) }} \tabularnewline
{% endfor %}
\bottomrule
\end{longtable}

\newpage

\section{Active Test Cases}

This section documents all active test cases that have a status in the Jira/ATM system of Draft, Defined or Approved.


{% for testcase in testcases %}

\subsection{{ '{' }}{{ testcase.key }} - {{ testcase.name }}{{ "}" }}{{ label(testcase.key.lower()) }}

\begin{longtable}[]{llllll}
\toprule
Version & Status & Priority & Verification Type & Owner
\\\midrule
{{ testcase.version }} & {{ testcase.status }} & {{ testcase.priority }} &
{{ testcase.verification_type }} & {{ testcase.owner }}
\\\bottomrule
\multicolumn{6}{c}{ Open {{ href(testcase.jira_url, testcase.key) }} in Jira } \\
\end{longtable}

\subsubsection{Verification Elements}
{% if testcase.requirements %}
\begin{itemize}
{% for item in testcase.requirements %}
\item {{ href(item.jira_url, item.key) }} - {{ item.summary }}
{% endfor %}
\end{itemize}
{% else %}
    None.
{% endif %}

\subsubsection{Test Items}
{% if testcase.objective %}
{{ testcase.objective }}
{% endif %}

{% if testcase.more_objectives %}
{% for title, objective in testcase.more_objectives.items() %}
\paragraph{ {{ title.replace("_", " ").title() }} }
{{ objective }}
{% endfor %}
{% endif %}

\subsubsection{Predecessors}
{% if testcase.predecessors %}
{{ testcase.predecessors }}
{% endif %}

\subsubsection{Environment Needs}

\paragraph{Software}
{% if testcase.required_software %}
{{ testcase.required_software }}
{% endif %}

\paragraph{Hardware}
{% if testcase.test_equipment %}
{{ testcase.test_equipment }}
{% endif %}

\subsubsection{Input Specification}
{% if testcase.precondition %}
{{ testcase.precondition }}
{% endif %}

\subsubsection{Output Specification}
{% if testcase.postcondition %}
{{ testcase.postcondition }}
{% endif %}

\subsubsection{Test Procedure}
{% if testcase.test_script %}
    \begin{longtable}[]{p{1.3cm}p{2cm}p{13cm}}
    %\toprule
    Step & \multicolumn{2}{@{}l}{Description, Input Data and Expected Result} \\ \toprule
    \endhead
    {% for step in testcase.test_script %}
        {% set rowloop = loop %}
        {% if step.test_case_key %}
            {% set step_testcase = testcases_map[step.test_case_key] %}
            {% for substep in step_testcase.test_script %}

                \multirow{3}{*}{\parbox{1.3cm}{ {{ rowloop.index }}-{{ loop.index }}
                {\scriptsize from \hyperref[{{ step_testcase.key.lower() }}]
                {{ curlies(step_testcase.key) }} } } }

                & {\small Description} &
                \begin{minipage}[t]{13cm}{\scriptsize
                {{ substep.description }}
                \vspace{\dp0}
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Test Data} &
                \begin{minipage}[t]{13cm}{\scriptsize
                {% if substep.test_data %}
                    {{ substep.test_data }}
                    \vspace{\dp0}
                {% endif %}
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Expected Result} &
                {% if substep.expected_result %}
                    \begin{minipage}[t]{13cm}{\scriptsize
                    {{ substep.expected_result }}
                    \vspace{\dp0}
                    } \end{minipage}
                {% endif %}
                \\ \hdashline

            {% endfor %}

        {% else %}

            \multirow{3}{*}{ {{ rowloop.index }} } & Description &
            \begin{minipage}[t]{13cm}{\footnotesize
            {{ step.description }}
            \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Test Data &
            \begin{minipage}[t]{13cm}{\footnotesize
            {% if step.test_data %}
                {{ step.test_data }}
                \vspace{\dp0}
            {% else %}
                No data.
                \vspace{\dp0}
            {% endif %}
            } \end{minipage} \\ \cline{2-3}
            {% if step.example_code %}
                & Example Code &
                \begin{minipage}[t]{13cm}{\footnotesize
                {{ step.example_code }}
                \vspace{\dp0}
                } \end{minipage} \\ \cline{2-3}
            {% endif %}
            & Expected Result &
            {% if step.expected_result %}
                \begin{minipage}[t]{13cm}{\footnotesize
                {{ step.expected_result }}
                \vspace{\dp0}
                } \end{minipage}
            {% endif %}
        {% endif %}
        \\ \midrule
    {% endfor %}
    \end{longtable}
{% endif %}
{% endfor %}

\newpage
\section{Reusable Test Cases}

Test cases in this section are made up of commonly encountered steps that have been factored out into modular, reusable scripts.
These test cases are meant solely for the building of actual tests used for verification, to be inserted in test scripts via the “Call to Test” functionality in Jira/ATM.
They streamline the process of writing test scripts by providing pre-designed steps, while also ensuring homogeneity throughout the test suite.
These reusable modules are not themselves verifying requirements.
Also, these test cases shall not call other reusable test cases in their script.


{% if libtestcases|length > 0 %}

{% for testcase in libtestcases %}

\subsection{{ '{' }}{{ testcase.key }} - {{ testcase.name }}{{ "}" }}{{ label(testcase.key.lower()) }}

\begin{longtable}[]{llllll}
\toprule
Version & Status & Priority & Verification Type & Owner
\\\midrule
{{ testcase.version }} & {{ testcase.status }} & {{ testcase.priority }} &
{{ testcase.verification_type }} & {{ testcase.owner }}
\\\bottomrule
\multicolumn{6}{c}{ Open {{ href(testcase.jira_url, testcase.key) }} in Jira } \\
\end{longtable}

\subsubsection{Test Items}
{% if testcase.objective %}
{{ testcase.objective }}
{% endif %}

{% if testcase.more_objectives %}
{% for title, objective in testcase.more_objectives.items() %}
\paragraph{ {{ title.replace("_", " ").title() }} }
{{ objective }}
{% endfor %}
{% endif %}

{% if testcase.predecessors %}
\subsubsection{Predecessors}
{{ testcase.predecessors }}
{% endif %}

{% if testcase.required_software or testcase.test_equipment %}
\subsubsection{Environment Needs}
{% endif %}

{% if testcase.required_software %}
\paragraph{Software}
{{ testcase.required_software }}
{% endif %}

{% if testcase.test_equipment %}
\paragraph{Hardware}
{{ testcase.test_equipment }}
{% endif %}

{% if testcase.precondition %}
\subsubsection{Input Specification}
{{ testcase.precondition }}
{% endif %}

{% if testcase.postcondition %}
\subsubsection{Output Specification}
{{ testcase.postcondition }}
{% endif %}

\subsubsection{Test Procedure}
{% if testcase.test_script %}
    \begin{longtable}[]{p{1.3cm}p{2cm}p{13cm}}
    %\toprule
    Step & \multicolumn{2}{@{}l}{Description, Input Data and Expected Result} \\ \toprule
    \endhead
    {% for step in testcase.test_script %}
        {% set rowloop = loop %}
        {% if step.test_case_key %}
            {% set step_testcase = testcases_map[step.test_case_key] %}
            {% for substep in step_testcase.test_script %}
                {% set id= rowloop.index|string ~ '-' ~ loop.index|string %}
                {{ write_step(id, step_testcase.key, substep) }}
            {% endfor %}

        {% else %}
            {{ write_step(rowloop.index, "", step) }}
        {% endif %}
        \\ \midrule
    {% endfor %}
    \end{longtable}
{% endif %}

{% endfor %}

{% else %}
  \textit{No reusable test cases found.}
{% endif %}



\newpage
\section{Deprecated Test Cases}

This section includes all test cases that have been marked as deprecated.
These test cases will never be executed again, but have been in the past.
For this reason it is important to keep them in the baseline as a reference.

{% if deprecated|length > 0 %}

{% for testcase in deprecated %}

\subsection{{ '{' }}{{ testcase.key }} - {{ testcase.name }}{{ "}" }}{{ label(testcase.key.lower()) }}

\begin{longtable}[]{llllll}
\toprule
Version & Status & Priority & Verification Type & Owner
\\\midrule
{{ testcase.version }} & {{ testcase.status }} & {{ testcase.priority }} &
{{ testcase.verification_type }} & {{ testcase.owner }}
\\\bottomrule
\multicolumn{6}{c}{ Open {{ href(testcase.jira_url, testcase.key) }} in Jira } \\
\end{longtable}

\subsubsection{Verification Elements}
{% if testcase.requirements %}
\begin{itemize}
{% for item in testcase.requirements %}
\item {{ href(item.jira_url, item.key) }} - {{ item.summary }}
{% endfor %}
\end{itemize}
{% else %}
    None.
{% endif %}

\subsubsection{Test Items}
{% if testcase.objective %}
{{ testcase.objective }}
{% endif %}

{% if testcase.more_objectives %}
{% for title, objective in testcase.more_objectives.items() %}
\paragraph{ {{ title.replace("_", " ").title() }} }
{{ objective }}
{% endfor %}
{% endif %}

{% endfor %}

{% else %}
  \textit{No deprecated test cases found.}
{% endif %}

\newpage
\appendix
