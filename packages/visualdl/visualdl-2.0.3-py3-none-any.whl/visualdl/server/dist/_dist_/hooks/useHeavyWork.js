import E from"../../__snowpack__/env.js";import.meta.env=E;import{useCallback as g,useEffect as h,useRef as y,useState as p}from"../../web_modules/react.js";const m=(l,s,d,e)=>{const u=y(null),n=y(null),[b,v]=p(void 0),o=g(t=>d&&v(d(t)),[d]);return h(()=>{try{if(l&&typeof WebAssembly!="undefined"){var t;u.current||(u.current=l()),(t=u.current)===null||t===void 0||t.then(i=>v(i(e))).catch(()=>o(e));return}if(s&&typeof Worker!="undefined"){var f,r,c;n.current||(n.current=s()),(f=n.current)===null||f===void 0||f.postMessage(e),(r=n.current)===null||r===void 0||r.addEventListener("message",({data:i})=>v(i)),(c=n.current)===null||c===void 0||c.addEventListener("error",()=>o(e));return}}catch(i){import.meta.env.MODE==="development"&&(console.error("Error during heavy work, trying to use fallback"),console.error(i)),o(e)}o(e)},[l,s,o,e]),b};export default m;
