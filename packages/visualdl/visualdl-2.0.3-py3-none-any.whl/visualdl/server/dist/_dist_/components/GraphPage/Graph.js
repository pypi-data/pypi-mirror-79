import N from"../../../__snowpack__/env.js";import.meta.env=N;import n,{useCallback as U,useEffect as a,useImperativeHandle as A,useMemo as B,useRef as K,useState as E}from"../../../web_modules/react.js";import{backgroundColor as V,borderColor as q,contentHeight as F,position as J,primaryColor as M,rem as s,size as C}from"../../utils/style.js";import Q from"../ChartToolbox.js";import X from"../../../web_modules/react-spinners/HashLoader.js";import Y from"../../assets/images/netron.png.proxy.js";import l from"../../../web_modules/styled-components.js";import{toast as Z}from"../../../web_modules/react-toastify.js";import{useTranslation as O}from"../../../web_modules/react-i18next.js";const L=import.meta.env.SNOWPACK_PUBLIC_PATH,G=s(40),D=l.div.withConfig({displayName:"Graph__Wrapper",componentId:"ojmbku-0"})(["position:relative;height:",";background-color:",";display:flex;flex-direction:column;justify-content:center;align-items:center;"],F,V),S=l.div.withConfig({displayName:"Graph__RenderContent",componentId:"ojmbku-1"})(["position:absolute;top:0;left:0;"," opacity:",";z-index:",";pointer-events:",";"],C("100%","100%"),i=>i.show?1:0,i=>i.show?0:-1,i=>i.show?"auto":"none"),ee=l(Q).withConfig({displayName:"Graph__Toolbox",componentId:"ojmbku-2"})(["height:",";border-bottom:1px solid ",";padding:0 ",";"],G,q,s(20)),te=l.div.withConfig({displayName:"Graph__Content",componentId:"ojmbku-3"})(["position:relative;height:calc(100% - ",");> iframe{"," border:none;}> .powered-by{display:block;"," color:#ddd;font-size:",";user-select:none;img{height:1em;opacity:0.5;vertical-align:middle;}}"],G,C("100%","100%"),J("absolute",null,null,s(20),s(30)),s(14)),oe=l.div.withConfig({displayName:"Graph__Loading",componentId:"ojmbku-4"})([""," display:flex;flex-direction:column;justify-content:center;align-items:center;overscroll-behavior:none;cursor:progress;font-size:",";line-height:",";"],C("100%","100%"),s(16),s(60)),H=n.forwardRef(({files:i,uploader:x,showAttributes:j,showInitializers:k,showNames:z,horizontal:R,onRendered:c,onOpened:d,onSearch:m,onShowModelProperties:u,onShowNodeProperties:p,onShowNodeDocumentation:_},I)=>{const{t:f}=O("graph"),[o,T]=E(!1),[h,g]=E(!1),[v,W]=E(!1),P=K(null),b=U(t=>{if(t.data){const{type:y,data:r}=t.data;switch(y){case"status":switch(r){case"ready":return T(!0);case"loading":return g(!0);case"rendered":g(!1),W(!0),c==null||c();return}return;case"opened":return d==null?void 0:d(r);case"search":return m==null?void 0:m(r);case"cancel":return g(!1);case"error":Z(r),g(!1);return;case"show-model-properties":return u==null?void 0:u(r);case"show-node-properties":return p==null?void 0:p(r);case"show-node-documentation":return _==null?void 0:_(r)}}},[c,d,m,u,p,_]),e=U((t,y)=>{var r,w;(r=P.current)===null||r===void 0||((w=r.contentWindow)===null||w===void 0)||w.postMessage({type:t,data:y},`${window.location.protocol}//${window.location.host}`)},[]);a(()=>(window.addEventListener("message",b),e("ready"),()=>{window.removeEventListener("message",b)}),[b,e]),a(()=>o&&e("change-files",i)||void 0,[e,i,o]),a(()=>o&&e("toggle-attributes",j)||void 0,[e,j,o]),a(()=>o&&e("toggle-initializers",k)||void 0,[e,k,o]),a(()=>o&&e("toggle-names",z)||void 0,[e,z,o]),a(()=>o&&e("toggle-direction",R)||void 0,[e,R,o]),A(I,()=>({export(t){e("export",t)},changeGraph(t){e("change-graph",t)},search(t){e("search",t)},select(t){e("select",t)},showModelProperties(){e("show-model-properties")},showNodeDocumentation(t){e("show-node-documentation",t)}}));const $=B(()=>!o||h?n.createElement(oe,null,n.createElement(X,{size:"60px",color:M})):o&&!v?x:null,[o,h,v,x]);return n.createElement(D,null,$,n.createElement(S,{show:!h&&v},n.createElement(ee,{items:[{icon:"restore-size",tooltip:f("graph:restore-size"),onClick:()=>e("zoom-reset")},{icon:"zoom-out",tooltip:f("graph:zoom-out"),onClick:()=>e("zoom-out")},{icon:"zoom-in",tooltip:f("graph:zoom-in"),onClick:()=>e("zoom-in")}],reversed:!0,tooltipPlacement:"bottom"}),n.createElement(te,null,n.createElement("iframe",{ref:P,src:`${L}/netron/index.html`,frameBorder:0,scrolling:"no",marginWidth:0,marginHeight:0}),n.createElement("a",{className:"powered-by",href:"https://github.com/lutzroeder/netron",target:"_blank",rel:"noreferrer"},"Powered by ",n.createElement("img",{src:L+Y,alt:"netron"})))))});H.displayName="Graph";export default H;
