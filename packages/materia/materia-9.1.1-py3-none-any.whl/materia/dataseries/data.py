from __future__ import annotations
from typing import Optional

import materia as mtr
import numpy as np

from .dataseries import ReflectanceSpectrum, RelativeSPDSpectrum, SPDSpectrum, Spectrum

__all__ = [
    "ASTMG173",
    "BlackbodySPD",
    "CIE1931ColorMatchingFunctionX",
    "CIE1931ColorMatchingFunctionY",
    "CIE1931ColorMatchingFunctionZ",
    "CIE1995TestColorSample01",
    "CIE1995TestColorSample02",
    "CIE1995TestColorSample03",
    "CIE1995TestColorSample04",
    "CIE1995TestColorSample05",
    "CIE1995TestColorSample06",
    "CIE1995TestColorSample07",
    "CIE1995TestColorSample08",
    "CIEIlluminantA",
    "CIEIlluminantD65",
    "CIEIlluminantDSeries",
    "CIEIlluminantF4",
    "SimmonsDSeriesPCA0",
    "SimmonsDSeriesPCA1",
    "SimmonsDSeriesPCA2",
]


class ASTMG173(SPDSpectrum):
    def __init__(self) -> None:
        # wavelengths in nms, global tilt spectrum in watts per square-meter per nm
        # taken directly from https://rredc.nrel.gov/solar//spectra/am1.5/ASTMG173/ASTMG173.html, accessed at 16:52 EST 17 Feb. 2019

        x = (
            np.hstack(
                [
                    np.linspace(280, 400, 241),
                    np.linspace(401, 1700, 1300),
                    1702,
                    np.linspace(1705, 4000, 460),
                ]
            )
            * mtr.nm
        )

        y = (
            [
                4.7309e-23,
                1.2307e-21,
                5.6895e-21,
                1.5662e-19,
                1.1946e-18,
                4.5436e-18,
                1.8452e-17,
                3.536e-17,
                7.267e-16,
                2.4856e-15,
                8.0142e-15,
                4.2613e-14,
                1.3684e-13,
                8.3823e-13,
                2.7367e-12,
                1.0903e-11,
                6.2337e-11,
                1.7162e-10,
                5.6265e-10,
                2.0749e-09,
                6.0168e-09,
                1.3783e-08,
                3.5052e-08,
                1.0913e-07,
                2.683e-07,
                4.2685e-07,
                8.6466e-07,
                2.2707e-06,
                4.1744e-06,
                6.5911e-06,
                1.229e-05,
                2.7826e-05,
                4.7904e-05,
                7.1345e-05,
                9.68e-05,
                0.00018608,
                0.00028988,
                0.00035789,
                0.00049211,
                0.00086068,
                0.0010205,
                0.001245,
                0.00193,
                0.0026914,
                0.0029209,
                0.004284,
                0.0070945,
                0.0089795,
                0.0094701,
                0.011953,
                0.016463,
                0.018719,
                0.018577,
                0.021108,
                0.027849,
                0.035635,
                0.037837,
                0.04143,
                0.040534,
                0.043306,
                0.050939,
                0.06554,
                0.082922,
                0.08408,
                0.093376,
                0.098984,
                0.10733,
                0.10757,
                0.11969,
                0.1306,
                0.13625,
                0.11838,
                0.12348,
                0.15036,
                0.17158,
                0.18245,
                0.17594,
                0.18591,
                0.2047,
                0.19589,
                0.20527,
                0.24525,
                0.25024,
                0.23843,
                0.22203,
                0.21709,
                0.21226,
                0.24861,
                0.27537,
                0.28321,
                0.27894,
                0.32436,
                0.3812,
                0.40722,
                0.39806,
                0.38465,
                0.35116,
                0.37164,
                0.42235,
                0.46878,
                0.47139,
                0.428,
                0.40262,
                0.41806,
                0.43623,
                0.43919,
                0.42944,
                0.40724,
                0.41497,
                0.44509,
                0.46388,
                0.45313,
                0.41519,
                0.38214,
                0.3738,
                0.40051,
                0.43411,
                0.45527,
                0.46355,
                0.47446,
                0.5018,
                0.50071,
                0.47139,
                0.46935,
                0.48934,
                0.50767,
                0.51489,
                0.48609,
                0.41843,
                0.40307,
                0.45898,
                0.48932,
                0.47778,
                0.48657,
                0.49404,
                0.47674,
                0.47511,
                0.48336,
                0.46564,
                0.47805,
                0.52798,
                0.56741,
                0.55172,
                0.53022,
                0.51791,
                0.48962,
                0.5204,
                0.57228,
                0.60498,
                0.61156,
                0.6114,
                0.59028,
                0.55387,
                0.51942,
                0.45673,
                0.46215,
                0.43006,
                0.39926,
                0.46953,
                0.56549,
                0.59817,
                0.56531,
                0.52024,
                0.50956,
                0.5342,
                0.5851,
                0.60191,
                0.58541,
                0.60628,
                0.60058,
                0.62359,
                0.68628,
                0.73532,
                0.73658,
                0.72285,
                0.70914,
                0.66759,
                0.6631,
                0.69315,
                0.74469,
                0.75507,
                0.68261,
                0.69338,
                0.72051,
                0.67444,
                0.64253,
                0.61886,
                0.55786,
                0.5564,
                0.55227,
                0.5893,
                0.65162,
                0.6748,
                0.6639,
                0.71225,
                0.79455,
                0.85595,
                0.83418,
                0.74389,
                0.66683,
                0.70077,
                0.75075,
                0.76383,
                0.68837,
                0.58678,
                0.50762,
                0.45499,
                0.44049,
                0.50968,
                0.61359,
                0.67355,
                0.64363,
                0.621,
                0.6457,
                0.65147,
                0.64204,
                0.63582,
                0.63136,
                0.68543,
                0.7597,
                0.79699,
                0.80371,
                0.85138,
                0.86344,
                0.79493,
                0.66257,
                0.47975,
                0.38152,
                0.49567,
                0.68385,
                0.80772,
                0.86038,
                0.75655,
                0.55017,
                0.42619,
                0.62945,
                0.85249,
                1.0069,
                1.0693,
                1.1021,
                1.1141,
                1.1603,
                1.2061,
                1.1613,
                1.1801,
                1.1511,
                1.1227,
                1.1026,
                1.1514,
                1.2299,
                1.0485,
                1.1738,
                1.2478,
                1.1971,
                1.1842,
                1.2258,
                1.2624,
                1.2312,
                1.1777,
                1.2258,
                1.1232,
                1.2757,
                1.2583,
                1.2184,
                1.2117,
                1.2488,
                1.2135,
                1.1724,
                1.1839,
                1.0963,
                0.87462,
                0.79394,
                1.3207,
                1.2288,
                1.1352,
                1.2452,
                1.3659,
                1.3943,
                1.2238,
                1.1775,
                1.3499,
                1.3313,
                1.425,
                1.4453,
                1.4084,
                1.4619,
                1.3108,
                1.4903,
                1.5081,
                1.5045,
                1.5595,
                1.6173,
                1.5482,
                1.4297,
                1.5335,
                1.5224,
                1.5724,
                1.5854,
                1.5514,
                1.5391,
                1.5291,
                1.5827,
                1.5975,
                1.6031,
                1.5544,
                1.535,
                1.5673,
                1.4973,
                1.5619,
                1.5682,
                1.5077,
                1.5331,
                1.6126,
                1.5499,
                1.5671,
                1.6185,
                1.5631,
                1.5724,
                1.623,
                1.5916,
                1.6181,
                1.6177,
                1.6236,
                1.6038,
                1.5734,
                1.5683,
                1.2716,
                1.4241,
                1.5413,
                1.4519,
                1.6224,
                1.5595,
                1.4869,
                1.5903,
                1.5525,
                1.6485,
                1.5676,
                1.5944,
                1.5509,
                1.5507,
                1.5451,
                1.4978,
                1.4966,
                1.5653,
                1.4587,
                1.5635,
                1.6264,
                1.556,
                1.5165,
                1.5893,
                1.5481,
                1.5769,
                1.6186,
                1.5206,
                1.4885,
                1.5314,
                1.5455,
                1.2594,
                1.4403,
                1.3957,
                1.5236,
                1.5346,
                1.569,
                1.4789,
                1.5905,
                1.5781,
                1.5341,
                1.3417,
                1.5357,
                1.6071,
                1.5446,
                1.6292,
                1.5998,
                1.4286,
                1.5302,
                1.5535,
                1.6199,
                1.4989,
                1.5738,
                1.5352,
                1.4825,
                1.4251,
                1.5511,
                1.5256,
                1.5792,
                1.5435,
                1.5291,
                1.549,
                1.5049,
                1.552,
                1.5399,
                1.5382,
                1.5697,
                1.525,
                1.5549,
                1.5634,
                1.5366,
                1.4988,
                1.531,
                1.4483,
                1.474,
                1.5595,
                1.4847,
                1.5408,
                1.5106,
                1.5201,
                1.4374,
                1.532,
                1.518,
                1.4807,
                1.4816,
                1.4331,
                1.5134,
                1.5198,
                1.5119,
                1.4777,
                1.4654,
                1.5023,
                1.456,
                1.477,
                1.502,
                1.5089,
                1.532,
                1.5479,
                1.5448,
                1.5324,
                1.4953,
                1.5281,
                1.4934,
                1.2894,
                1.3709,
                1.4662,
                1.4354,
                1.4561,
                1.4491,
                1.4308,
                1.4745,
                1.4788,
                1.4607,
                1.4606,
                1.4753,
                1.4579,
                1.436,
                1.4664,
                1.4921,
                1.4895,
                1.4822,
                1.4911,
                1.4862,
                1.4749,
                1.4686,
                1.4611,
                1.4831,
                1.4621,
                1.4176,
                1.4697,
                1.431,
                1.4128,
                1.4664,
                1.4733,
                1.4739,
                1.4802,
                1.4269,
                1.4165,
                1.4118,
                1.4026,
                1.4012,
                1.4417,
                1.3631,
                1.4114,
                1.3924,
                1.4161,
                1.3638,
                1.4508,
                1.4284,
                1.4458,
                1.4128,
                1.461,
                1.4707,
                1.4646,
                1.434,
                1.4348,
                1.4376,
                1.4525,
                1.4462,
                1.4567,
                1.415,
                1.4086,
                1.3952,
                1.3519,
                1.3594,
                1.4447,
                1.3871,
                1.4311,
                1.4153,
                1.3499,
                1.1851,
                1.2393,
                1.3855,
                1.3905,
                1.3992,
                1.3933,
                1.3819,
                1.3844,
                1.3967,
                1.4214,
                1.4203,
                1.4102,
                1.415,
                1.4394,
                1.4196,
                1.4169,
                1.3972,
                1.4094,
                1.4074,
                1.3958,
                1.412,
                1.3991,
                1.4066,
                1.3947,
                1.3969,
                1.3915,
                1.3981,
                1.383,
                1.3739,
                1.3748,
                1.3438,
                0.96824,
                1.1206,
                1.1278,
                1.1821,
                1.2333,
                1.2689,
                1.2609,
                1.2464,
                1.2714,
                1.2684,
                1.3403,
                1.3192,
                1.2918,
                1.2823,
                1.2659,
                1.2674,
                1.2747,
                1.3078,
                1.3214,
                1.3144,
                1.309,
                1.3048,
                1.3095,
                1.3175,
                1.3155,
                1.3071,
                1.2918,
                1.3029,
                1.2587,
                1.2716,
                1.1071,
                1.0296,
                0.92318,
                0.9855,
                1.0861,
                1.2407,
                1.1444,
                1.0555,
                1.038,
                1.0813,
                1.085,
                1.04,
                1.0466,
                1.1285,
                1.0703,
                1.1534,
                1.1962,
                1.2357,
                1.2178,
                1.2059,
                1.2039,
                1.2269,
                1.1905,
                1.2195,
                1.2148,
                1.2153,
                1.2405,
                1.2503,
                1.2497,
                1.247,
                1.2477,
                1.2401,
                1.2357,
                1.2341,
                1.2286,
                1.233,
                1.2266,
                1.242,
                1.2383,
                1.2232,
                1.2221,
                1.2295,
                1.1945,
                0.26604,
                0.15396,
                0.68766,
                0.37952,
                0.53878,
                0.68601,
                0.81461,
                0.97417,
                1.1138,
                1.1278,
                1.1608,
                1.1686,
                1.1778,
                1.1771,
                1.1771,
                1.1771,
                1.1798,
                1.1727,
                1.1713,
                1.1765,
                1.1636,
                1.1607,
                1.1662,
                1.1614,
                1.1536,
                1.1586,
                1.1592,
                1.145,
                1.1305,
                1.1257,
                1.091,
                1.1058,
                1.0953,
                1.0875,
                1.0972,
                1.0932,
                1.0742,
                1.0913,
                1.1121,
                1.0905,
                1.0725,
                1.0843,
                1.0856,
                1.0657,
                1.0782,
                1.0545,
                1.0974,
                1.0859,
                1.0821,
                1.0548,
                1.0559,
                1.0533,
                1.0268,
                1.0086,
                0.90356,
                0.89523,
                0.83216,
                0.85183,
                0.82259,
                0.90519,
                0.86188,
                0.99764,
                0.95157,
                0.67271,
                0.93506,
                0.96935,
                0.93381,
                0.98465,
                0.84979,
                0.9293,
                0.91601,
                0.92392,
                0.89426,
                0.9565,
                0.93412,
                1.0032,
                0.97234,
                1.0092,
                0.99901,
                1.0013,
                1.0157,
                1.0101,
                0.99703,
                1.0053,
                0.98631,
                1.0165,
                1.0187,
                0.9917,
                0.99217,
                0.98596,
                0.89372,
                0.97493,
                0.96927,
                0.96486,
                0.85112,
                0.913,
                0.97317,
                0.99166,
                0.99196,
                0.99171,
                0.98816,
                0.98679,
                0.99449,
                1.0005,
                0.97916,
                0.96324,
                0.849,
                0.91546,
                0.9592,
                0.94956,
                0.96755,
                0.95387,
                0.96686,
                0.95721,
                0.94042,
                0.92687,
                0.95277,
                0.95615,
                0.95237,
                0.93656,
                0.93957,
                0.90861,
                0.93245,
                0.92927,
                0.93305,
                0.94423,
                0.90752,
                0.91062,
                0.92228,
                0.93455,
                0.92393,
                0.92584,
                0.90881,
                0.87327,
                0.8513,
                0.81357,
                0.76253,
                0.66566,
                0.7178,
                0.54871,
                0.7426,
                0.59933,
                0.66791,
                0.68889,
                0.84457,
                0.81709,
                0.77558,
                0.63854,
                0.65217,
                0.70431,
                0.62467,
                0.66808,
                0.68893,
                0.62834,
                0.62649,
                0.67836,
                0.57646,
                0.73017,
                0.59271,
                0.73877,
                0.74414,
                0.78049,
                0.70026,
                0.74504,
                0.7215,
                0.7111,
                0.70331,
                0.78742,
                0.58968,
                0.55127,
                0.4321,
                0.40921,
                0.30086,
                0.24841,
                0.1438,
                0.25084,
                0.16142,
                0.16338,
                0.20058,
                0.39887,
                0.47181,
                0.37195,
                0.40532,
                0.27834,
                0.28579,
                0.36821,
                0.19461,
                0.37112,
                0.27423,
                0.49396,
                0.14726,
                0.48378,
                0.26891,
                0.34362,
                0.42411,
                0.34117,
                0.32821,
                0.27067,
                0.46101,
                0.37385,
                0.42066,
                0.4612,
                0.44174,
                0.50503,
                0.4586,
                0.50374,
                0.50275,
                0.5024,
                0.6521,
                0.68622,
                0.63461,
                0.71397,
                0.68765,
                0.60648,
                0.57529,
                0.58987,
                0.57191,
                0.63864,
                0.61509,
                0.63815,
                0.60468,
                0.71338,
                0.69218,
                0.66865,
                0.73732,
                0.68817,
                0.75083,
                0.73928,
                0.73462,
                0.74906,
                0.73227,
                0.75358,
                0.75102,
                0.73728,
                0.7541,
                0.75176,
                0.74884,
                0.73971,
                0.73887,
                0.73857,
                0.73532,
                0.74442,
                0.72805,
                0.73442,
                0.72336,
                0.68174,
                0.71252,
                0.72753,
                0.72685,
                0.71972,
                0.71914,
                0.72278,
                0.71877,
                0.71761,
                0.72068,
                0.70817,
                0.71129,
                0.70337,
                0.71422,
                0.68878,
                0.69896,
                0.70175,
                0.6897,
                0.69508,
                0.69058,
                0.69753,
                0.69636,
                0.69305,
                0.69385,
                0.68628,
                0.69055,
                0.68736,
                0.68787,
                0.67613,
                0.68015,
                0.68234,
                0.68202,
                0.67497,
                0.67172,
                0.67636,
                0.6717,
                0.67176,
                0.672,
                0.66525,
                0.66833,
                0.66452,
                0.64714,
                0.65694,
                0.66274,
                0.65896,
                0.65463,
                0.65521,
                0.65118,
                0.64919,
                0.64646,
                0.64847,
                0.64641,
                0.64482,
                0.63818,
                0.61875,
                0.63585,
                0.62121,
                0.63266,
                0.62239,
                0.63196,
                0.62913,
                0.61713,
                0.62032,
                0.61944,
                0.58626,
                0.60469,
                0.61661,
                0.61536,
                0.60363,
                0.62158,
                0.59252,
                0.61471,
                0.60434,
                0.60321,
                0.60474,
                0.59722,
                0.58083,
                0.5894,
                0.59814,
                0.57852,
                0.5933,
                0.5541,
                0.56697,
                0.59317,
                0.57919,
                0.55573,
                0.58835,
                0.58124,
                0.51058,
                0.53965,
                0.52067,
                0.50323,
                0.57852,
                0.50291,
                0.50772,
                0.48577,
                0.49696,
                0.46883,
                0.46637,
                0.46765,
                0.50644,
                0.39792,
                0.48304,
                0.41565,
                0.41278,
                0.47899,
                0.33154,
                0.41357,
                0.2685,
                0.29985,
                0.24987,
                0.20136,
                0.079618,
                0.21753,
                0.11317,
                0.14189,
                0.18586,
                0.081686,
                0.12817,
                0.1087,
                0.14428,
                0.051589,
                0.15725,
                0.099224,
                0.10591,
                0.070574,
                0.2956,
                0.23411,
                0.15331,
                0.04174,
                0.015462,
                0.12876,
                0.28785,
                0.20329,
                0.2985,
                0.25599,
                0.19337,
                0.22479,
                0.31183,
                0.11326,
                0.14604,
                0.15764,
                0.059176,
                0.27113,
                0.21854,
                0.12164,
                0.2034,
                0.24762,
                0.23812,
                0.14248,
                0.31316,
                0.2809,
                0.31458,
                0.31171,
                0.33693,
                0.28648,
                0.34753,
                0.35002,
                0.46857,
                0.40188,
                0.3886,
                0.37494,
                0.40996,
                0.41954,
                0.4231,
                0.45873,
                0.44831,
                0.45483,
                0.45642,
                0.33692,
                0.4524,
                0.47679,
                0.47235,
                0.36,
                0.48371,
                0.44069,
                0.45514,
                0.32318,
                0.4387,
                0.41985,
                0.40741,
                0.47715,
                0.45575,
                0.33504,
                0.41569,
                0.46239,
                0.4466,
                0.47336,
                0.45434,
                0.4689,
                0.44696,
                0.43131,
                0.47715,
                0.43392,
                0.36489,
                0.44825,
                0.43708,
                0.43717,
                0.43409,
                0.36247,
                0.43692,
                0.48086,
                0.42986,
                0.43346,
                0.41428,
                0.45336,
                0.42232,
                0.42489,
                0.46956,
                0.43407,
                0.4278,
                0.4664,
                0.45528,
                0.45934,
                0.44663,
                0.45805,
                0.46531,
                0.45139,
                0.44406,
                0.44808,
                0.46236,
                0.46819,
                0.43304,
                0.46658,
                0.46721,
                0.46003,
                0.47203,
                0.46633,
                0.45397,
                0.47016,
                0.46504,
                0.46908,
                0.46339,
                0.46797,
                0.46272,
                0.46077,
                0.46197,
                0.46247,
                0.45754,
                0.45528,
                0.45655,
                0.45945,
                0.45746,
                0.4586,
                0.45966,
                0.45705,
                0.45258,
                0.45097,
                0.44773,
                0.44363,
                0.4507,
                0.44023,
                0.43532,
                0.44496,
                0.42725,
                0.4311,
                0.41146,
                0.39567,
                0.40019,
                0.37148,
                0.3957,
                0.38527,
                0.38822,
                0.37051,
                0.24652,
                0.38744,
                0.40825,
                0.40879,
                0.40625,
                0.40614,
                0.41233,
                0.41693,
                0.42001,
                0.42763,
                0.42456,
                0.42204,
                0.41335,
                0.37305,
                0.40733,
                0.42078,
                0.42399,
                0.42714,
                0.42213,
                0.41989,
                0.40936,
                0.41285,
                0.41786,
                0.39618,
                0.41257,
                0.40421,
                0.40514,
                0.38957,
                0.3713,
                0.39183,
                0.40852,
                0.35312,
                0.36228,
                0.39181,
                0.34621,
                0.30062,
                0.38382,
                0.38453,
                0.30594,
                0.34696,
                0.38413,
                0.30114,
                0.33366,
                0.33337,
                0.31352,
                0.28833,
                0.28581,
                0.32419,
                0.31217,
                0.33328,
                0.26855,
                0.25872,
                0.29866,
                0.30217,
                0.23279,
                0.26249,
                0.32224,
                0.28051,
                0.26625,
                0.2345,
                0.17759,
                0.22923,
                0.1448,
                0.14579,
                0.20304,
                0.16925,
                0.23117,
                0.18348,
                0.16454,
                0.17804,
                0.17681,
                0.16831,
                0.17039,
                0.17798,
                0.12711,
                0.075645,
                0.10904,
                0.058186,
                0.060119,
                0.0047451,
                0.016159,
                0.016025,
                0.0046298,
                0.0015164,
                9.6096e-05,
                0.00029009,
                3.6034e-06,
                4.807e-05,
                7.1786e-05,
                4.1948e-06,
                7.3439e-07,
                2.1404e-06,
                4.8133e-09,
                1.8076e-11,
                3.1563e-06,
                1.3589e-06,
                9.0764e-12,
                1.2791e-05,
                4.9764e-06,
                1.481e-13,
                5.1667e-07,
                2.92e-07,
                1.9731e-08,
                2.7498e-06,
                4.4401e-05,
                0.00017917,
                0.00032332,
                0.00025748,
                0.0001227,
                0.0011089,
                5.2164e-05,
                8.1587e-05,
                2.3716e-06,
                2.5672e-06,
                4.4017e-08,
                6.1689e-07,
                2.0899e-06,
                2.5215e-06,
                0.00019896,
                4.0262e-06,
                0.00058098,
                0.00049328,
                0.00034384,
                2.3782e-05,
                0.00011586,
                7.5526e-05,
                6.7136e-07,
                6.3215e-09,
                4.9057e-05,
                0.0012704,
                0.00081226,
                3.2466e-09,
                1.0528e-08,
                0.0018353,
                0.00238,
                0.00073892,
                3.6444e-07,
                0.0020448,
                0.00017457,
                0.0016493,
                0.00061919,
                0.00046653,
                0.0021142,
                0.0026396,
                0.023353,
                0.00036378,
                0.00018366,
                0.035565,
                0.011759,
                0.013559,
                0.0021442,
                0.0082718,
                0.0091637,
                0.046314,
                0.0092198,
                0.016975,
                0.02585,
                0.027792,
                0.049546,
                0.0045588,
                0.03802,
                0.061601,
                0.050156,
                0.0025194,
                0.035834,
                0.020962,
                0.021416,
                0.038351,
                0.02988,
                0.013263,
                0.051039,
                0.039601,
                0.0318,
                0.036317,
                0.045063,
                0.061791,
                0.049751,
                0.023095,
                0.036215,
                0.11569,
                0.10213,
                0.027412,
                0.011271,
                0.062361,
                0.081978,
                0.13759,
                0.06615,
                0.088509,
                0.117,
                0.13643,
                0.16307,
                0.085421,
                0.090276,
                0.1306,
                0.043225,
                0.15184,
                0.093383,
                0.065197,
                0.036054,
                0.076942,
                0.094845,
                0.049678,
                0.017848,
                0.046771,
                0.070198,
                0.097339,
                0.18463,
                0.068778,
                0.069736,
                0.06348,
                0.12001,
                0.060637,
                0.11529,
                0.05849,
                0.14859,
                0.13747,
                0.12503,
                0.1234,
                0.060629,
                0.09418,
                0.18973,
                0.17478,
                0.19778,
                0.16441,
                0.18157,
                0.20367,
                0.18253,
                0.16852,
                0.2285,
                0.18968,
                0.21759,
                0.25061,
                0.26552,
                0.23356,
                0.18493,
                0.16029,
                0.18402,
                0.25773,
                0.25514,
                0.24302,
                0.1869,
                0.27052,
                0.26474,
                0.26068,
                0.24239,
                0.22571,
                0.26573,
                0.25683,
                0.24929,
                0.25211,
                0.24437,
                0.2645,
                0.27505,
                0.26378,
                0.28004,
                0.27539,
                0.25884,
                0.26745,
                0.2622,
                0.27928,
                0.27244,
                0.25522,
                0.26973,
                0.27839,
                0.27714,
                0.26892,
                0.26686,
                0.27464,
                0.27336,
                0.27202,
                0.27295,
                0.26491,
                0.26904,
                0.26927,
                0.27208,
                0.2721,
                0.27705,
                0.27481,
                0.27309,
                0.26675,
                0.27342,
                0.2699,
                0.27058,
                0.27182,
                0.27132,
                0.26474,
                0.26759,
                0.2631,
                0.27062,
                0.26848,
                0.26808,
                0.26568,
                0.27002,
                0.26756,
                0.26667,
                0.26264,
                0.26728,
                0.26245,
                0.26308,
                0.25722,
                0.25452,
                0.24175,
                0.23507,
                0.23775,
                0.23407,
                0.24145,
                0.23974,
                0.24678,
                0.21602,
                0.23516,
                0.23672,
                0.24464,
                0.2487,
                0.24195,
                0.24755,
                0.24904,
                0.25874,
                0.25569,
                0.25303,
                0.25107,
                0.23233,
                0.24179,
                0.24197,
                0.25225,
                0.25833,
                0.25624,
                0.25823,
                0.24452,
                0.24692,
                0.25421,
                0.24202,
                0.2381,
                0.22323,
                0.22413,
                0.22397,
                0.22842,
                0.23683,
                0.2414,
                0.23296,
                0.2299,
                0.22727,
                0.2176,
                0.2268,
                0.23076,
                0.23719,
                0.23838,
                0.24104,
                0.2305,
                0.23465,
                0.24352,
                0.241,
                0.23449,
                0.2343,
                0.23754,
                0.24246,
                0.24269,
                0.23782,
                0.23971,
                0.24078,
                0.24126,
                0.24137,
                0.23651,
                0.23806,
                0.23821,
                0.23267,
                0.23282,
                0.23367,
                0.23539,
                0.227,
                0.22007,
                0.22026,
                0.21511,
                0.2196,
                0.22082,
                0.21535,
                0.22355,
                0.21822,
                0.21749,
                0.22768,
                0.21655,
                0.21867,
                0.22526,
                0.20855,
                0.22373,
                0.22277,
                0.21583,
                0.22231,
                0.22101,
                0.22223,
                0.22487,
                0.2212,
                0.22332,
                0.22384,
                0.21908,
                0.22235,
                0.22098,
                0.21178,
                0.17884,
                0.21068,
                0.21459,
                0.21516,
                0.22168,
                0.21879,
                0.21147,
                0.21629,
                0.21575,
                0.2136,
                0.21145,
                0.21229,
                0.20915,
                0.21303,
                0.20558,
                0.19447,
                0.20366,
                0.20906,
                0.19797,
                0.21321,
                0.21026,
                0.20484,
                0.21013,
                0.20718,
                0.20523,
                0.19303,
                0.20708,
                0.21134,
                0.20477,
                0.20968,
                0.20922,
                0.18107,
                0.20739,
                0.20551,
                0.19975,
                0.20396,
                0.19778,
                0.1879,
                0.18965,
                0.18698,
                0.17808,
                0.17407,
                0.16154,
                0.16818,
                0.15481,
                0.16566,
                0.15301,
                0.15998,
                0.13284,
                0.14172,
                0.11484,
                0.1005,
                0.076981,
                0.088904,
                0.046931,
                0.031828,
                0.014815,
                0.0096911,
                0.0032816,
                0.00098755,
                0.0012744,
                5.2041e-06,
                6.419e-06,
                6.2703e-08,
                6.2658e-06,
                2.9993e-06,
                2.8396e-07,
                1.1151e-05,
                1.6982e-05,
                2.6662e-10,
                4.513e-10,
                7.7505e-05,
                4.389e-05,
                0.00022333,
                0.00012947,
                8.6221e-07,
                5.6667e-07,
                2.3045e-05,
                1.9947e-05,
                0.00045069,
                0.00093615,
                0.00055242,
                0.0035935,
                0.0032821,
                0.010863,
                0.016727,
                0.010036,
                0.021906,
                0.028563,
                0.048847,
                0.067857,
                0.075512,
                0.083063,
                0.085613,
                0.08119,
                0.038156,
                0.015001,
                0.039748,
                0.026648,
                0.044981,
                0.07401,
                0.084856,
                0.096386,
                0.089781,
                0.091074,
                0.067927,
                0.054906,
                0.069193,
                0.061875,
                0.065676,
                0.077443,
                0.086812,
                0.085102,
                0.0891,
                0.089747,
                0.086133,
                0.093153,
                0.089654,
                0.091673,
                0.087588,
                0.088632,
                0.089774,
                0.090044,
                0.090767,
                0.089486,
                0.084639,
                0.08484,
                0.08417,
                0.07631,
                0.081996,
                0.080448,
                0.081808,
                0.07455,
                0.079068,
                0.078992,
                0.071202,
                0.07401,
                0.079315,
                0.076273,
                0.07773,
                0.075453,
                0.075773,
                0.074299,
                0.073118,
                0.070838,
                0.071937,
                0.06769,
                0.066929,
                0.068137,
                0.064867,
                0.064021,
                0.066288,
                0.06308,
                0.06322,
                0.061265,
                0.058824,
                0.059171,
                0.06387,
                0.058141,
                0.052031,
                0.056215,
                0.056824,
                0.057967,
                0.045836,
                0.0514,
                0.041536,
                0.047473,
                0.050237,
                0.049409,
                0.030817,
                0.044147,
                0.042552,
                0.030826,
                0.037109,
                0.040594,
                0.04415,
                0.033599,
                0.033813,
                0.0273,
                0.02659,
                0.033078,
                0.045099,
                0.014878,
                0.043249,
                0.020798,
                0.013611,
                0.024853,
                0.033363,
                0.024148,
                0.016727,
                0.016455,
                0.0080395,
                0.0056102,
                0.0035113,
                0.0028772,
                0.0070642,
                0.0015191,
                0.0022163,
                0.0005188,
                0.00037054,
                4.1393e-05,
                6.3593e-07,
                1.7502e-07,
                3.7716e-07,
                5.3758e-11,
                2.8222e-13,
                1.0435e-09,
                3.102e-11,
                1.5955e-14,
                1.5258e-18,
                1.0786e-27,
                3.8214e-22,
                1.7194e-34,
                5.4793e-31,
                2.2838e-33,
                4.4912e-28,
                5.8053e-35,
                5.9447e-34,
                1.1196e-37,
                5.6505e-29,
                3.8687e-28,
                2.8026e-45,
                3.9027e-16,
                1.175e-16,
                8.9988e-19,
                1.4295e-19,
                1.3133e-27,
                2.6068e-25,
                1.1123e-37,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0226e-29,
                7.1284e-33,
                0.0,
                2.9315e-42,
                1.125e-35,
                3.8557e-26,
                5.6052e-45,
                7.2935e-22,
                6.0734e-19,
                5.4888e-21,
                2.3314e-27,
                1.3146e-23,
                1.6648e-28,
                6.7262e-44,
                0.0,
                2.6777e-27,
                8.3791e-24,
                3.999e-38,
                4.8067e-34,
                3.8866e-27,
                1.217e-16,
                3.6205e-16,
                1.6484e-12,
                6.7478e-14,
                4.0233e-10,
                2.8685e-10,
                2.0548e-11,
                1.7605e-07,
                3.9008e-06,
                2.1276e-10,
                1.9609e-07,
                4.0575e-05,
                1.1566e-06,
                4.4867e-07,
                2.5356e-05,
                0.00016763,
                6.3129e-06,
                0.0003917,
                0.00024724,
                0.00045332,
                0.00018623,
                0.0026643,
                0.00081152,
                0.00011096,
                0.002722,
                0.0012581,
                0.0028948,
                0.0010835,
                0.0058858,
                0.0064903,
                0.0016273,
                0.0014489,
                0.0052276,
                0.0023361,
                0.0045971,
                0.0074379,
                0.00035233,
                0.00085429,
                0.0013381,
                0.0069628,
                0.01028,
                0.0042755,
                0.0078472,
                0.0028906,
                0.0068479,
                0.0055551,
                0.00063369,
                0.0075031,
                0.0060753,
                0.0024986,
                0.0020242,
                0.004209,
                0.0010321,
                0.00028947,
                0.0063012,
                0.0029113,
                0.0017492,
                0.0060221,
                0.0036224,
                0.0017671,
                0.0023805,
                0.0006551,
                0.004401,
                0.00092155,
                0.00084569,
                0.0022677,
                0.0098197,
                0.0030289,
                0.0057614,
                0.011446,
                0.0033241,
                0.0032517,
                0.0066744,
                0.0056366,
                0.009232,
                0.014017,
                0.012516,
                0.0092302,
                0.010621,
                0.0080823,
                0.0042388,
                0.0026927,
                0.00043843,
                0.00030973,
                0.00013634,
                0.00049752,
                0.0016089,
                0.00019875,
                0.0003408,
                0.007294,
                0.0037464,
                0.00073409,
                0.0026067,
                0.0099378,
                0.0012248,
                0.0024465,
                0.0012186,
                0.0059265,
                0.0028644,
                0.011128,
                0.0087571,
                0.0012234,
                0.0017794,
                0.0039416,
                0.0039235,
                1.6133e-05,
                5.9987e-05,
                0.0035187,
                0.0046616,
                0.0090694,
                0.0034602,
                0.0035408,
                0.0080277,
                0.0036308,
                0.0052402,
                0.0071907,
                0.0039389,
                0.008456,
                0.0051115,
                0.0074896,
                0.0098552,
                0.0095465,
                0.012509,
                0.0044594,
                0.0070802,
                0.0072774,
                0.013165,
                0.010006,
                0.0086892,
                0.011553,
                0.0080348,
                0.011318,
                0.011153,
                0.0083089,
                0.01253,
                0.0098179,
                0.012264,
                0.010943,
                0.011224,
                0.012094,
                0.010419,
                0.012265,
                0.011917,
                0.011809,
                0.011963,
                0.011494,
                0.012122,
                0.011428,
                0.011127,
                0.0094556,
                0.009031,
                0.0095432,
                0.010538,
                0.0090581,
                0.010795,
                0.010851,
                0.0083376,
                0.0086444,
                0.010187,
                0.0091671,
                0.0094523,
                0.00967,
                0.010262,
                0.010359,
                0.0094787,
                0.0094726,
                0.011614,
                0.010239,
                0.009955,
                0.010299,
                0.01148,
                0.010599,
                0.010123,
                0.010978,
                0.010914,
                0.010253,
                0.0079003,
                0.0048286,
                0.0083312,
                0.009438,
                0.0096922,
                0.010132,
                0.010878,
                0.01077,
                0.009364,
                0.0092254,
                0.010376,
                0.010698,
                0.0092707,
                0.0085837,
                0.0088494,
                0.010331,
                0.0092903,
                0.0089918,
                0.0088633,
                0.0085502,
                0.0091243,
                0.0090521,
                0.0095746,
                0.0088123,
                0.0077564,
                0.0088692,
                0.0098592,
                0.0093049,
                0.0082451,
                0.0077569,
                0.009655,
                0.0095056,
                0.0095925,
                0.0076916,
                0.0089756,
                0.0087801,
                0.0088274,
                0.0085085,
                0.007994,
                0.0080989,
                0.0073604,
                0.006762,
                0.006534,
                0.0067717,
                0.0068818,
                0.007476,
                0.0079254,
                0.0079269,
                0.0071353,
                0.0069868,
                0.0069466,
                0.006852,
                0.0070502,
                0.0073541,
                0.0074027,
                0.0075412,
                0.0076277,
                0.0077199,
                0.0077482,
                0.0078057,
                0.0076806,
                0.0075097,
                0.0073872,
                0.0074327,
                0.0073723,
                0.00721,
                0.0071043,
            ]
            * mtr.watt
            / (mtr.m ** 2 * mtr.nm)
        )

        super().__init__(x=x, y=y)


class BlackbodySPD(RelativeSPDSpectrum):
    def __init__(self, T, normalize_to=100):
        if not isinstance(T, mtr.Quantity):
            T = T * mtr.K

        x = np.linspace(380, 780, 1001) * mtr.nm

        c2 = (mtr.h * mtr.c / mtr.kB).convert(mtr.nm * mtr.K)

        # NOTE: wrong overall prefactor, but that's okay since it will be normalized in super().__init__
        y = x ** (-5) / (np.exp((c2 / (x * T)).value) - 1)

        super().__init__(x=x, y=y, normalize_to=normalize_to)


class CIE1931ColorMatchingFunctionX(Spectrum):
    def __init__(self):
        # data taken from https://web.archive.org/web/20170131100357/http://files.cie.co.at/204.xls
        x = np.linspace(380, 780, 81) * mtr.nm

        xbar = [
            0.001368,
            0.002236,
            0.004243,
            0.007650,
            0.014310,
            0.023190,
            0.043510,
            0.077630,
            0.134380,
            0.214770,
            0.283900,
            0.328500,
            0.348280,
            0.348060,
            0.336200,
            0.318700,
            0.290800,
            0.251100,
            0.195360,
            0.142100,
            0.095640,
            0.057950,
            0.032010,
            0.014700,
            0.004900,
            0.002400,
            0.009300,
            0.029100,
            0.063270,
            0.109600,
            0.165500,
            0.225750,
            0.290400,
            0.359700,
            0.433450,
            0.512050,
            0.594500,
            0.678400,
            0.762100,
            0.842500,
            0.916300,
            0.978600,
            1.026300,
            1.056700,
            1.062200,
            1.045600,
            1.002600,
            0.938400,
            0.854450,
            0.751400,
            0.642400,
            0.541900,
            0.447900,
            0.360800,
            0.283500,
            0.218700,
            0.164900,
            0.121200,
            0.087400,
            0.063600,
            0.046770,
            0.032900,
            0.022700,
            0.015840,
            0.011359,
            0.008111,
            0.005790,
            0.004109,
            0.002899,
            0.002049,
            0.001440,
            0.001000,
            0.000690,
            0.000476,
            0.000332,
            0.000235,
            0.000166,
            0.000117,
            0.000083,
            0.000059,
            0.000042,
        ] * mtr.unitless

        super().__init__(x=x, y=xbar)


class CIE1931ColorMatchingFunctionY(Spectrum):
    def __init__(self):
        # data taken from https://web.archive.org/web/20170131100357/http://files.cie.co.at/204.xls
        x = np.linspace(380, 780, 81) * mtr.nm

        ybar = [
            0.000039,
            0.000064,
            0.000120,
            0.000217,
            0.000396,
            0.000640,
            0.001210,
            0.002180,
            0.004000,
            0.007300,
            0.011600,
            0.016840,
            0.023000,
            0.029800,
            0.038000,
            0.048000,
            0.060000,
            0.073900,
            0.090980,
            0.112600,
            0.139020,
            0.169300,
            0.208020,
            0.258600,
            0.323000,
            0.407300,
            0.503000,
            0.608200,
            0.710000,
            0.793200,
            0.862000,
            0.914850,
            0.954000,
            0.980300,
            0.994950,
            1.000000,
            0.995000,
            0.978600,
            0.952000,
            0.915400,
            0.870000,
            0.816300,
            0.757000,
            0.694900,
            0.631000,
            0.566800,
            0.503000,
            0.441200,
            0.381000,
            0.321000,
            0.265000,
            0.217000,
            0.175000,
            0.138200,
            0.107000,
            0.081600,
            0.061000,
            0.044580,
            0.032000,
            0.023200,
            0.017000,
            0.011920,
            0.008210,
            0.005723,
            0.004102,
            0.002929,
            0.002091,
            0.001484,
            0.001047,
            0.000740,
            0.000520,
            0.000361,
            0.000249,
            0.000172,
            0.000120,
            0.000085,
            0.000060,
            0.000042,
            0.000030,
            0.000021,
            0.000015,
        ] * mtr.unitless

        super().__init__(x=x, y=ybar)


class CIE1931ColorMatchingFunctionZ(Spectrum):
    def __init__(self):
        # data taken from https://web.archive.org/web/20170131100357/http://files.cie.co.at/204.xls
        x = np.linspace(380, 780, 81) * mtr.nm

        zbar = [
            0.006450,
            0.010550,
            0.020050,
            0.036210,
            0.067850,
            0.110200,
            0.207400,
            0.371300,
            0.645600,
            1.039050,
            1.385600,
            1.622960,
            1.747060,
            1.782600,
            1.772110,
            1.744100,
            1.669200,
            1.528100,
            1.287640,
            1.041900,
            0.812950,
            0.616200,
            0.465180,
            0.353300,
            0.272000,
            0.212300,
            0.158200,
            0.111700,
            0.078250,
            0.057250,
            0.042160,
            0.029840,
            0.020300,
            0.013400,
            0.008750,
            0.005750,
            0.003900,
            0.002750,
            0.002100,
            0.001800,
            0.001650,
            0.001400,
            0.001100,
            0.001000,
            0.000800,
            0.000600,
            0.000340,
            0.000240,
            0.000190,
            0.000100,
            0.000050,
            0.000030,
            0.000020,
            0.000010,
            0.000000,
            0.000000,
            0.000000,
            0.000000,
            0.000000,
            0.000000,
            0.000000,
            0.000000,
            0.000000,
            0.000000,
            0.000000,
            0.000000,
            0.000000,
            0.000000,
            0.000000,
            0.000000,
            0.000000,
            0.000000,
            0.000000,
            0.000000,
            0.000000,
            0.000000,
            0.000000,
            0.000000,
            0.000000,
            0.000000,
            0.000000,
        ] * mtr.unitless

        super().__init__(x=x, y=zbar)


class CIE1995TestColorSample01(ReflectanceSpectrum):
    def __init__(self):
        # data taken from https://web.archive.org/web/20090211042805/http://photometry.kriss.re.kr/wiki/img_auth.php/4/47/CIE_TCS.csv
        x = np.linspace(360, 830, 95) * mtr.nm

        tcs01 = [
            0.116,
            0.136,
            0.159,
            0.19,
            0.219,
            0.239,
            0.252,
            0.256,
            0.256,
            0.254,
            0.252,
            0.248,
            0.244,
            0.24,
            0.237,
            0.232,
            0.23,
            0.226,
            0.225,
            0.222,
            0.22,
            0.218,
            0.216,
            0.214,
            0.214,
            0.214,
            0.216,
            0.218,
            0.223,
            0.225,
            0.226,
            0.226,
            0.225,
            0.225,
            0.227,
            0.23,
            0.236,
            0.245,
            0.253,
            0.262,
            0.272,
            0.283,
            0.298,
            0.318,
            0.341,
            0.367,
            0.39,
            0.409,
            0.424,
            0.435,
            0.442,
            0.448,
            0.45,
            0.451,
            0.451,
            0.451,
            0.451,
            0.451,
            0.45,
            0.45,
            0.451,
            0.451,
            0.453,
            0.454,
            0.455,
            0.457,
            0.458,
            0.46,
            0.462,
            0.463,
            0.464,
            0.465,
            0.466,
            0.466,
            0.466,
            0.466,
            0.467,
            0.467,
            0.467,
            0.467,
            0.467,
            0.467,
            0.467,
            0.467,
            0.467,
            0.467,
            0.467,
            0.466,
            0.466,
            0.466,
            0.466,
            0.466,
            0.465,
            0.464,
            0.464,
        ]
        y = tcs01 * mtr.unitless

        super().__init__(x=x, y=y)


class CIE1995TestColorSample02(ReflectanceSpectrum):
    def __init__(self):
        # data taken from https://web.archive.org/web/20090211042805/http://photometry.kriss.re.kr/wiki/img_auth.php/4/47/CIE_TCS.csv
        x = mtr.np.linspace(360, 830, 95) * mtr.nm

        tcs02 = [
            0.053,
            0.055,
            0.059,
            0.064,
            0.07,
            0.079,
            0.089,
            0.101,
            0.111,
            0.116,
            0.118,
            0.12,
            0.121,
            0.122,
            0.122,
            0.122,
            0.123,
            0.124,
            0.127,
            0.128,
            0.131,
            0.134,
            0.138,
            0.143,
            0.15,
            0.159,
            0.174,
            0.19,
            0.207,
            0.225,
            0.242,
            0.253,
            0.26,
            0.264,
            0.267,
            0.269,
            0.272,
            0.276,
            0.282,
            0.289,
            0.299,
            0.309,
            0.322,
            0.329,
            0.335,
            0.339,
            0.341,
            0.341,
            0.342,
            0.342,
            0.342,
            0.341,
            0.341,
            0.339,
            0.339,
            0.338,
            0.338,
            0.337,
            0.336,
            0.335,
            0.334,
            0.332,
            0.332,
            0.331,
            0.331,
            0.33,
            0.329,
            0.328,
            0.328,
            0.327,
            0.326,
            0.325,
            0.324,
            0.324,
            0.324,
            0.323,
            0.322,
            0.321,
            0.32,
            0.318,
            0.316,
            0.315,
            0.315,
            0.314,
            0.314,
            0.313,
            0.313,
            0.312,
            0.312,
            0.311,
            0.311,
            0.311,
            0.311,
            0.311,
            0.31,
        ]
        y = tcs02 * mtr.unitless

        super().__init__(x=x, y=y)


class CIE1995TestColorSample03(ReflectanceSpectrum):
    def __init__(self):
        # data taken from https://web.archive.org/web/20090211042805/http://photometry.kriss.re.kr/wiki/img_auth.php/4/47/CIE_TCS.csv
        x = np.linspace(360, 830, 95) * mtr.nm

        tcs03 = [
            0.058,
            0.059,
            0.061,
            0.063,
            0.065,
            0.068,
            0.07,
            0.072,
            0.073,
            0.073,
            0.074,
            0.074,
            0.074,
            0.073,
            0.073,
            0.073,
            0.073,
            0.073,
            0.074,
            0.075,
            0.077,
            0.08,
            0.085,
            0.094,
            0.109,
            0.126,
            0.148,
            0.172,
            0.198,
            0.221,
            0.241,
            0.26,
            0.278,
            0.302,
            0.339,
            0.37,
            0.392,
            0.399,
            0.4,
            0.393,
            0.38,
            0.365,
            0.349,
            0.332,
            0.315,
            0.299,
            0.285,
            0.272,
            0.264,
            0.257,
            0.252,
            0.247,
            0.241,
            0.235,
            0.229,
            0.224,
            0.22,
            0.217,
            0.216,
            0.216,
            0.219,
            0.224,
            0.23,
            0.238,
            0.251,
            0.269,
            0.288,
            0.312,
            0.34,
            0.366,
            0.39,
            0.412,
            0.431,
            0.447,
            0.46,
            0.472,
            0.481,
            0.488,
            0.493,
            0.497,
            0.5,
            0.502,
            0.505,
            0.51,
            0.516,
            0.52,
            0.524,
            0.527,
            0.531,
            0.535,
            0.539,
            0.544,
            0.548,
            0.552,
            0.555,
        ]
        y = tcs03 * mtr.unitless

        super().__init__(x=x, y=y)


class CIE1995TestColorSample04(ReflectanceSpectrum):
    def __init__(self):
        # data taken from https://web.archive.org/web/20090211042805/http://photometry.kriss.re.kr/wiki/img_auth.php/4/47/CIE_TCS.csv
        x = np.linspace(360, 830, 95) * mtr.nm

        tcs04 = [
            0.057,
            0.059,
            0.062,
            0.067,
            0.074,
            0.083,
            0.093,
            0.105,
            0.116,
            0.121,
            0.124,
            0.126,
            0.128,
            0.131,
            0.135,
            0.139,
            0.144,
            0.151,
            0.161,
            0.172,
            0.186,
            0.205,
            0.229,
            0.254,
            0.281,
            0.308,
            0.332,
            0.352,
            0.37,
            0.383,
            0.39,
            0.394,
            0.395,
            0.392,
            0.385,
            0.377,
            0.367,
            0.354,
            0.341,
            0.327,
            0.312,
            0.296,
            0.28,
            0.263,
            0.247,
            0.229,
            0.214,
            0.198,
            0.185,
            0.175,
            0.169,
            0.164,
            0.16,
            0.156,
            0.154,
            0.152,
            0.151,
            0.149,
            0.148,
            0.148,
            0.148,
            0.149,
            0.151,
            0.154,
            0.158,
            0.162,
            0.165,
            0.168,
            0.17,
            0.171,
            0.17,
            0.168,
            0.166,
            0.164,
            0.164,
            0.165,
            0.168,
            0.172,
            0.177,
            0.181,
            0.185,
            0.189,
            0.192,
            0.194,
            0.197,
            0.2,
            0.204,
            0.21,
            0.218,
            0.225,
            0.233,
            0.243,
            0.254,
            0.264,
            0.274,
        ]
        y = tcs04 * mtr.unitless

        super().__init__(x=x, y=y)


class CIE1995TestColorSample05(ReflectanceSpectrum):
    def __init__(self):
        # data taken from https://web.archive.org/web/20090211042805/http://photometry.kriss.re.kr/wiki/img_auth.php/4/47/CIE_TCS.csv
        x = np.linspace(360, 830, 95) * mtr.nm

        tcs05 = [
            0.143,
            0.187,
            0.233,
            0.269,
            0.295,
            0.306,
            0.31,
            0.312,
            0.313,
            0.315,
            0.319,
            0.322,
            0.326,
            0.33,
            0.334,
            0.339,
            0.346,
            0.352,
            0.36,
            0.369,
            0.381,
            0.394,
            0.403,
            0.41,
            0.415,
            0.418,
            0.419,
            0.417,
            0.413,
            0.409,
            0.403,
            0.396,
            0.389,
            0.381,
            0.372,
            0.363,
            0.353,
            0.342,
            0.331,
            0.32,
            0.308,
            0.296,
            0.284,
            0.271,
            0.26,
            0.247,
            0.232,
            0.22,
            0.21,
            0.2,
            0.194,
            0.189,
            0.185,
            0.183,
            0.18,
            0.177,
            0.176,
            0.175,
            0.175,
            0.175,
            0.175,
            0.177,
            0.18,
            0.183,
            0.186,
            0.189,
            0.192,
            0.195,
            0.199,
            0.2,
            0.199,
            0.198,
            0.196,
            0.195,
            0.195,
            0.196,
            0.197,
            0.2,
            0.203,
            0.205,
            0.208,
            0.212,
            0.215,
            0.217,
            0.219,
            0.222,
            0.226,
            0.231,
            0.237,
            0.243,
            0.249,
            0.257,
            0.265,
            0.273,
            0.28,
        ]
        y = tcs05 * mtr.unitless

        super().__init__(x=x, y=y)


class CIE1995TestColorSample06(ReflectanceSpectrum):
    def __init__(self):
        # data taken from https://web.archive.org/web/20090211042805/http://photometry.kriss.re.kr/wiki/img_auth.php/4/47/CIE_TCS.csv
        x = np.linspace(360, 830, 95) * mtr.nm

        tcs06 = [
            0.079,
            0.081,
            0.089,
            0.113,
            0.151,
            0.203,
            0.265,
            0.339,
            0.41,
            0.464,
            0.492,
            0.508,
            0.517,
            0.524,
            0.531,
            0.538,
            0.544,
            0.551,
            0.556,
            0.556,
            0.554,
            0.549,
            0.541,
            0.531,
            0.519,
            0.504,
            0.488,
            0.469,
            0.45,
            0.431,
            0.414,
            0.395,
            0.377,
            0.358,
            0.341,
            0.325,
            0.309,
            0.293,
            0.279,
            0.265,
            0.253,
            0.241,
            0.234,
            0.227,
            0.225,
            0.222,
            0.221,
            0.22,
            0.22,
            0.22,
            0.22,
            0.22,
            0.223,
            0.227,
            0.233,
            0.239,
            0.244,
            0.251,
            0.258,
            0.263,
            0.268,
            0.273,
            0.278,
            0.281,
            0.283,
            0.286,
            0.291,
            0.296,
            0.302,
            0.313,
            0.325,
            0.338,
            0.351,
            0.364,
            0.376,
            0.389,
            0.401,
            0.413,
            0.425,
            0.436,
            0.447,
            0.458,
            0.469,
            0.477,
            0.485,
            0.493,
            0.5,
            0.506,
            0.512,
            0.517,
            0.521,
            0.525,
            0.529,
            0.532,
            0.535,
        ]
        y = tcs06 * mtr.unitless

        super().__init__(x=x, y=y)


class CIE1995TestColorSample07(ReflectanceSpectrum):
    def __init__(self):
        # data taken from https://web.archive.org/web/20090211042805/http://photometry.kriss.re.kr/wiki/img_auth.php/4/47/CIE_TCS.csv
        x = np.linspace(360, 830, 95) * mtr.nm

        tcs07 = [
            0.15,
            0.177,
            0.218,
            0.293,
            0.378,
            0.459,
            0.524,
            0.546,
            0.551,
            0.555,
            0.559,
            0.56,
            0.561,
            0.558,
            0.556,
            0.551,
            0.544,
            0.535,
            0.522,
            0.506,
            0.488,
            0.469,
            0.448,
            0.429,
            0.408,
            0.385,
            0.363,
            0.341,
            0.324,
            0.311,
            0.301,
            0.291,
            0.283,
            0.273,
            0.265,
            0.26,
            0.257,
            0.257,
            0.259,
            0.26,
            0.26,
            0.258,
            0.256,
            0.254,
            0.254,
            0.259,
            0.27,
            0.284,
            0.302,
            0.324,
            0.344,
            0.362,
            0.377,
            0.389,
            0.4,
            0.41,
            0.42,
            0.429,
            0.438,
            0.445,
            0.452,
            0.457,
            0.462,
            0.466,
            0.468,
            0.47,
            0.473,
            0.477,
            0.483,
            0.489,
            0.496,
            0.503,
            0.511,
            0.518,
            0.525,
            0.532,
            0.539,
            0.546,
            0.553,
            0.559,
            0.565,
            0.57,
            0.575,
            0.578,
            0.581,
            0.583,
            0.585,
            0.587,
            0.588,
            0.589,
            0.59,
            0.59,
            0.59,
            0.591,
            0.592,
        ]
        y = tcs07 * mtr.unitless

        super().__init__(x=x, y=y)


class CIE1995TestColorSample08(ReflectanceSpectrum):
    def __init__(self):
        # data taken from https://web.archive.org/web/20090211042805/http://photometry.kriss.re.kr/wiki/img_auth.php/4/47/CIE_TCS.csv
        x = np.linspace(360, 830, 95) * mtr.nm

        tcs08 = [
            0.075,
            0.078,
            0.084,
            0.09,
            0.104,
            0.129,
            0.17,
            0.24,
            0.319,
            0.416,
            0.462,
            0.482,
            0.49,
            0.488,
            0.482,
            0.473,
            0.462,
            0.45,
            0.439,
            0.426,
            0.413,
            0.397,
            0.382,
            0.366,
            0.352,
            0.337,
            0.325,
            0.31,
            0.299,
            0.289,
            0.283,
            0.276,
            0.27,
            0.262,
            0.256,
            0.251,
            0.25,
            0.251,
            0.254,
            0.258,
            0.264,
            0.269,
            0.272,
            0.274,
            0.278,
            0.284,
            0.295,
            0.316,
            0.348,
            0.384,
            0.434,
            0.482,
            0.528,
            0.568,
            0.604,
            0.629,
            0.648,
            0.663,
            0.676,
            0.685,
            0.693,
            0.7,
            0.705,
            0.709,
            0.712,
            0.715,
            0.717,
            0.719,
            0.721,
            0.72,
            0.719,
            0.722,
            0.725,
            0.727,
            0.729,
            0.73,
            0.73,
            0.73,
            0.73,
            0.73,
            0.73,
            0.73,
            0.73,
            0.73,
            0.73,
            0.73,
            0.731,
            0.731,
            0.731,
            0.731,
            0.731,
            0.731,
            0.731,
            0.731,
            0.731,
        ]
        y = tcs08 * mtr.unitless

        super().__init__(x=x, y=y)


class CIEIlluminantA(RelativeSPDSpectrum):
    def __init__(self, normalize_to: Optional[float] = 100) -> None:
        # data taken from https://web.archive.org/web/20170131100357/http://files.cie.co.at/204.xls
        x = np.linspace(300, 780, 97) * mtr.nm

        y = [
            0.930483,
            1.128210,
            1.357690,
            1.622190,
            1.925080,
            2.269800,
            2.659810,
            3.098610,
            3.589680,
            4.136480,
            4.742380,
            5.410700,
            6.144620,
            6.947200,
            7.821350,
            8.769800,
            9.795100,
            10.899600,
            12.085300,
            13.354300,
            14.708000,
            16.148000,
            17.675300,
            19.290700,
            20.995000,
            22.788300,
            24.670900,
            26.642500,
            28.702700,
            30.850800,
            33.085900,
            35.406800,
            37.812100,
            40.300200,
            42.869300,
            45.517400,
            48.242300,
            51.041800,
            53.913200,
            56.853900,
            59.861100,
            62.932000,
            66.063500,
            69.252500,
            72.495900,
            75.790300,
            79.132600,
            82.519300,
            85.947000,
            89.412400,
            92.912000,
            96.442300,
            100.000000,
            103.582000,
            107.184000,
            110.803000,
            114.436000,
            118.080000,
            121.731000,
            125.386000,
            129.043000,
            132.697000,
            136.346000,
            139.988000,
            143.618000,
            147.235000,
            150.836000,
            154.418000,
            157.979000,
            161.516000,
            165.028000,
            168.510000,
            171.963000,
            175.383000,
            178.769000,
            182.118000,
            185.429000,
            188.701000,
            191.931000,
            195.118000,
            198.261000,
            201.359000,
            204.409000,
            207.411000,
            210.365000,
            213.268000,
            216.120000,
            218.920000,
            221.667000,
            224.361000,
            227.000000,
            229.585000,
            232.115000,
            234.589000,
            237.008000,
            239.370000,
            241.675000,
        ] * mtr.unitless

        super().__init__(x=x, y=y, normalize_to=normalize_to)


class CIEIlluminantD65(RelativeSPDSpectrum):
    def __init__(self, normalize_to: Optional[float] = 100) -> None:
        # data taken from https://web.archive.org/web/20170131100357/http://files.cie.co.at/204.xls
        x = np.linspace(300, 830, 107) * mtr.nm
        y = [
            0.034100,
            1.664300,
            3.294500,
            11.765200,
            20.236000,
            28.644700,
            37.053500,
            38.501100,
            39.948800,
            42.430200,
            44.911700,
            45.775000,
            46.638300,
            49.363700,
            52.089100,
            51.032300,
            49.975500,
            52.311800,
            54.648200,
            68.701500,
            82.754900,
            87.120400,
            91.486000,
            92.458900,
            93.431800,
            90.057000,
            86.682300,
            95.773600,
            104.865000,
            110.936000,
            117.008000,
            117.410000,
            117.812000,
            116.336000,
            114.861000,
            115.392000,
            115.923000,
            112.367000,
            108.811000,
            109.082000,
            109.354000,
            108.578000,
            107.802000,
            106.296000,
            104.790000,
            106.239000,
            107.689000,
            106.047000,
            104.405000,
            104.225000,
            104.046000,
            102.023000,
            100.000000,
            98.167100,
            96.334200,
            96.061100,
            95.788000,
            92.236800,
            88.685600,
            89.345900,
            90.006200,
            89.802600,
            89.599100,
            88.648900,
            87.698700,
            85.493600,
            83.288600,
            83.493900,
            83.699200,
            81.863000,
            80.026800,
            80.120700,
            80.214600,
            81.246200,
            82.277800,
            80.281000,
            78.284200,
            74.002700,
            69.721300,
            70.665200,
            71.609100,
            72.979000,
            74.349000,
            67.976500,
            61.604000,
            65.744800,
            69.885600,
            72.486300,
            75.087000,
            69.339800,
            63.592700,
            55.005400,
            46.418200,
            56.611800,
            66.805400,
            65.094100,
            63.382800,
            63.843400,
            64.304000,
            61.877900,
            59.451900,
            55.705400,
            51.959000,
            54.699800,
            57.440600,
            58.876500,
            60.312500,
        ] * mtr.unitless

        super().__init__(x=x, y=y, normalize_to=normalize_to)


class CIEIlluminantDSeries(RelativeSPDSpectrum):
    def __init__(self, T, normalize_to: Optional[float] = 100) -> None:
        # data taken from https://web.archive.org/web/20170131100357/http://files.cie.co.at/204.xls
        wavs = np.linspace(300, 830, 107) * mtr.nm

        # equations taken from http://www.brucelindbloom.com/Eqn_T_to_xy.html
        if T >= 4000 and T <= 7000:
            x = (
                -4.6070e9 / T ** 3 + 2.9678e6 / T ** 2 + 0.09911e3 / T + 0.244063
            )  # (-4.6070e9/T**3 + 2.9678e6/T**2 + 0.09911e3/T + 0.244063)*mtr.unitless
        elif T > 7000 and T <= 25000:
            x = (
                -2.0064e9 / T ** 3 + 1.9018e6 / T ** 2 + 0.24748e3 / T + 0.237040
            )  # (-2.0064e9/T**3 + 1.9018e6/T**2 + 0.24748e3/T + 0.237040)*mtr.unitless

        y = -3.000 * x ** 2 + 2.870 * x - 0.275

        # equations taken from http://www.brucelindbloom.com/index.html?Eqn_DIlluminant.html
        M = 0.0241 + 0.2562 * x - 0.7341 * y
        M1 = (-1.3515 - 1.7703 * x + 5.9114 * y) / M
        M2 = (0.0300 - 31.4424 * x + 30.0717 * y) / M
        vals = (
            SimmonsDSeriesPCA0().y
            + M1 * SimmonsDSeriesPCA1().y
            + M2 * SimmonsDSeriesPCA2().y
        )

        super().__init__(x=wavs, y=vals, normalize_to=normalize_to)


class CIEIlluminantF4(RelativeSPDSpectrum):
    def __init__(self, normalize_to: Optional[float] = 100) -> None:
        # data taken from https://web.archive.org/web/20100612203959/http://www.cis.rit.edu/mcsl/online/CIE/Fluorescents.xls
        x = np.linspace(380, 780, 81) * mtr.nm
        y = [
            0.57,
            0.7,
            0.87,
            0.98,
            2.01,
            13.75,
            1.95,
            1.59,
            1.76,
            1.93,
            2.1,
            30.28,
            8.03,
            2.55,
            2.7,
            2.82,
            2.91,
            2.99,
            3.04,
            3.08,
            3.09,
            3.09,
            3.14,
            3.06,
            3,
            2.98,
            3.01,
            3.14,
            3.41,
            3.9,
            4.69,
            5.81,
            7.32,
            22.59,
            15.11,
            13.88,
            16.33,
            18.68,
            20.64,
            24.28,
            26.26,
            23.28,
            22.94,
            22.14,
            20.91,
            19.43,
            17.74,
            16,
            14.42,
            12.56,
            10.93,
            9.52,
            8.18,
            7.01,
            6,
            5.11,
            4.36,
            3.69,
            3.13,
            2.64,
            2.24,
            1.91,
            1.7,
            1.39,
            1.18,
            1.03,
            0.88,
            0.74,
            0.64,
            0.54,
            0.49,
            0.46,
            0.42,
            0.37,
            0.37,
            0.33,
            0.35,
            0.36,
            0.31,
            0.26,
            0.19,
        ] * mtr.unitless

        super().__init__(x=x, y=y, normalize_to=normalize_to)


class SimmonsDSeriesPCA0(SPDSpectrum):
    def __init__(self):
        # data taken from https://web.archive.org/web/20170131100357/http://files.cie.co.at/204.xls
        x = np.linspace(300, 830, 107) * mtr.nm

        y = [
            0.04,
            3.02,
            6.00,
            17.80,
            29.60,
            42.45,
            55.30,
            56.30,
            57.30,
            59.55,
            61.80,
            61.65,
            61.50,
            65.15,
            68.80,
            66.10,
            63.40,
            64.60,
            65.80,
            80.30,
            94.80,
            99.80,
            104.80,
            105.35,
            105.90,
            101.35,
            96.80,
            105.35,
            113.90,
            119.75,
            125.60,
            125.55,
            125.50,
            123.40,
            121.30,
            121.30,
            121.30,
            117.40,
            113.50,
            113.30,
            113.10,
            111.95,
            110.80,
            108.65,
            106.50,
            107.65,
            108.80,
            107.05,
            105.30,
            104.85,
            104.40,
            102.20,
            100.00,
            98.00,
            96.00,
            95.55,
            95.10,
            92.10,
            89.10,
            89.80,
            90.50,
            90.40,
            90.30,
            89.35,
            88.40,
            86.20,
            84.00,
            84.55,
            85.10,
            83.50,
            81.90,
            82.25,
            82.60,
            83.75,
            84.90,
            83.10,
            81.30,
            76.60,
            71.90,
            73.10,
            74.30,
            75.35,
            76.40,
            69.85,
            63.30,
            67.50,
            71.70,
            74.35,
            77.00,
            71.10,
            65.20,
            56.45,
            47.70,
            58.15,
            68.60,
            66.80,
            65.00,
            65.50,
            66.00,
            63.50,
            61.00,
            57.15,
            53.30,
            56.10,
            58.90,
            60.40,
            61.90,
        ] * mtr.unitless

        super().__init__(x=x, y=y)


class SimmonsDSeriesPCA1(SPDSpectrum):
    def __init__(self):
        # data taken from https://web.archive.org/web/20170131100357/http://files.cie.co.at/204.xls
        x = np.linspace(300, 830, 107) * mtr.nm

        y = [
            0.02,
            2.26,
            4.50,
            13.45,
            22.40,
            32.20,
            42.00,
            41.30,
            40.60,
            41.10,
            41.60,
            39.80,
            38.00,
            40.20,
            42.40,
            40.45,
            38.50,
            36.75,
            35.00,
            39.20,
            43.40,
            44.85,
            46.30,
            45.10,
            43.90,
            40.50,
            37.10,
            36.90,
            36.70,
            36.30,
            35.90,
            34.25,
            32.60,
            30.25,
            27.90,
            26.10,
            24.30,
            22.20,
            20.10,
            18.15,
            16.20,
            14.70,
            13.20,
            10.90,
            8.60,
            7.35,
            6.10,
            5.15,
            4.20,
            3.05,
            1.90,
            0.95,
            0.00,
            -0.80,
            -1.60,
            -2.55,
            -3.50,
            -3.50,
            -3.50,
            -4.65,
            -5.80,
            -6.50,
            -7.20,
            -7.90,
            -8.60,
            -9.05,
            -9.50,
            -10.20,
            -10.90,
            -10.80,
            -10.70,
            -11.35,
            -12.00,
            -13.00,
            -14.00,
            -13.80,
            -13.60,
            -12.80,
            -12.00,
            -12.65,
            -13.30,
            -13.10,
            -12.90,
            -11.75,
            -10.60,
            -11.10,
            -11.60,
            -11.90,
            -12.20,
            -11.20,
            -10.20,
            -9.00,
            -7.80,
            -9.50,
            -11.20,
            -10.80,
            -10.40,
            -10.50,
            -10.60,
            -10.15,
            -9.70,
            -9.00,
            -8.30,
            -8.80,
            -9.30,
            -9.55,
            -9.80,
        ] * mtr.unitless

        super().__init__(x=x, y=y)


class SimmonsDSeriesPCA2(SPDSpectrum):
    def __init__(self):
        # data taken from https://web.archive.org/web/20170131100357/http://files.cie.co.at/204.xls
        x = np.linspace(300, 830, 107) * mtr.nm

        y = [
            0.00,
            1.00,
            2.00,
            3.00,
            4.00,
            6.25,
            8.50,
            8.15,
            7.80,
            7.25,
            6.70,
            6.00,
            5.30,
            5.70,
            6.10,
            4.55,
            3.00,
            2.10,
            1.20,
            0.05,
            -1.10,
            -0.80,
            -0.50,
            -0.60,
            -0.70,
            -0.95,
            -1.20,
            -1.90,
            -2.60,
            -2.75,
            -2.90,
            -2.85,
            -2.80,
            -2.70,
            -2.60,
            -2.60,
            -2.60,
            -2.20,
            -1.80,
            -1.65,
            -1.50,
            -1.40,
            -1.30,
            -1.25,
            -1.20,
            -1.10,
            -1.00,
            -0.75,
            -0.50,
            -0.40,
            -0.30,
            -0.15,
            0.00,
            0.10,
            0.20,
            0.35,
            0.50,
            1.30,
            2.10,
            2.65,
            3.20,
            3.65,
            4.10,
            4.40,
            4.70,
            4.90,
            5.10,
            5.90,
            6.70,
            7.00,
            7.30,
            7.95,
            8.60,
            9.20,
            9.80,
            10.00,
            10.20,
            9.25,
            8.30,
            8.95,
            9.60,
            9.05,
            8.50,
            7.75,
            7.00,
            7.30,
            7.60,
            7.80,
            8.00,
            7.35,
            6.70,
            5.95,
            5.20,
            6.30,
            7.40,
            7.10,
            6.80,
            6.90,
            7.00,
            6.70,
            6.40,
            5.95,
            5.50,
            5.80,
            6.10,
            6.30,
            6.50,
        ] * mtr.unitless

        super().__init__(x=x, y=y)
